[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None
PlayResX: 1080
PlayResY: 720

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: 辉英,Tahoma,35,&H00FFFFFF,&H000000FF,&H003B3C3D,&H00000000,0,0,0,0,70,70,1,0,1,1.3,0.2,2,0,0,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,00:00:00.000,00:00:13.800,辉英,,0,0,0,,If we write the solution u, which is a function of t, a vector function of t, as u1, u2, etc. to u n minus 1,
Dialogue: 0,00:00:14.260,00:00:20.540,辉英,,0,0,0,,assuming we know the boundary conditions, which means we don't have to solve for u0 and u n,
Dialogue: 0,00:00:20.540,00:00:34.800,辉英,,0,0,0,,then what we have is du as a vector dt would be equal to something times u.
Dialogue: 0,00:00:35.340,00:00:36.260,辉英,,0,0,0,,What is that something?
Dialogue: 0,00:00:38.340,00:00:38.500,辉英,,0,0,0,,Yeah?
Dialogue: 0,00:00:38.500,00:00:44.080,辉英,,0,0,0,,It's a trinomial matrix where it's 1, negative 2, 1, to this, to that.
Dialogue: 0,00:00:44.880,00:00:46.380,辉英,,0,0,0,,It's going to be a matrix, right?
Dialogue: 0,00:00:46.880,00:00:50.180,辉英,,0,0,0,,And the matrix can be constructed by looking at the coefficients.
Dialogue: 0,00:00:50.540,00:00:59.180,辉英,,0,0,0,,For example, the diagonal entries of the matrix is the coefficients corresponding to the same ui as the i that appears on the left-hand side.
Dialogue: 0,00:01:00.040,00:01:09.240,辉英,,0,0,0,,That coefficient, kappa times minus 2, divided by delta x squared, is what is going to be appearing on the diagonal.
Dialogue: 0,00:01:11.820,00:01:17.420,辉英,,0,0,0,,And that is the same in this case for every diagonal element.
Dialogue: 0,00:01:17.420,00:01:25.600,辉英,,0,0,0,,There are also going to be off-diagonal elements corresponding to ui plus 1 and ui minus 1.
Dialogue: 0,00:01:26.340,00:01:34.020,辉英,,0,0,0,,Because the ui's are ordered in an increasing manner, the one corresponding to ui plus 1 is going to be where?
Dialogue: 0,00:01:37.640,00:01:40.100,辉英,,0,0,0,,Think of how you multiply a matrix and a vector.
Dialogue: 0,00:01:42.100,00:01:43.060,辉英,,0,0,0,,To the right.
Dialogue: 0,00:01:43.420,00:01:44.360,辉英,,0,0,0,,To the right.
Dialogue: 0,00:01:44.540,00:01:46.100,辉英,,0,0,0,,It's going to be on the upper diagonal because...
Dialogue: 0,00:01:47.420,00:01:51.740,辉英,,0,0,0,,So you are going to be multiplying, let's say this is ui, ui plus 1.
Dialogue: 0,00:01:51.740,00:01:59.100,辉英,,0,0,0,,You need to multiply this element and put it on this row of the equation.
Dialogue: 0,00:01:59.520,00:02:01.340,辉英,,0,0,0,,So that has to be here.
Dialogue: 0,00:02:01.340,00:02:03.640,辉英,,0,0,0,,So kappa divided by delta x squared.
Dialogue: 0,00:02:03.640,00:02:09.600,辉英,,0,0,0,,And in this case, if you make an error, it actually doesn't matter because the lower diagonal is the same number.
Dialogue: 0,00:02:09.600,00:02:13.340,辉英,,0,0,0,,But that's not true for all discretizations.
Dialogue: 0,00:02:17.420,00:02:25.300,辉英,,0,0,0,,And if you just look at this, this corresponds to boundary conditions of u0 and un equal to both 0.
Dialogue: 0,00:02:26.400,00:02:28.300,辉英,,0,0,0,,Because the very first equation...
Dialogue: 0,00:02:30.060,00:02:34.120,辉英,,0,0,0,,The very first equation does not have a term corresponding to u0.
Dialogue: 0,00:02:34.120,00:02:36.120,辉英,,0,0,0,,The very last term does not have a...
Dialogue: 0,00:02:36.120,00:02:38.120,辉英,,0,0,0,,So this is nothing.
Dialogue: 0,00:02:38.120,00:02:40.120,辉英,,0,0,0,,This is also nothing, right?
Dialogue: 0,00:02:41.880,00:02:45.620,辉英,,0,0,0,,Nothing means the coefficient here multiplied by 0.
Dialogue: 0,00:02:45.620,00:02:46.120,辉英,,0,0,0,,.
Dialogue: 0,00:02:46.120,00:02:46.620,辉英,,0,0,0,,.
Dialogue: 0,00:02:46.620,00:02:47.120,辉英,,0,0,0,,.
Dialogue: 0,00:02:47.120,00:02:52.120,辉英,,0,0,0,,And in case you have non-trivial boundary conditions, how should you modify this matrix equation?
Dialogue: 0,00:02:56.720,00:02:57.220,辉英,,0,0,0,,Hmm?
Dialogue: 0,00:02:58.320,00:02:59.420,辉英,,0,0,0,,Interpolation?
Dialogue: 0,00:03:01.420,00:03:03.620,辉英,,0,0,0,,Yeah, but what should you...
Dialogue: 0,00:03:03.620,00:03:04.120,辉英,,0,0,0,,Hmm?
Dialogue: 0,00:03:04.120,00:03:05.620,辉英,,0,0,0,,You make it a circular matrix.
Dialogue: 0,00:03:06.020,00:03:07.620,辉英,,0,0,0,,You make it a circular matrix?
Dialogue: 0,00:03:07.920,00:03:11.920,辉英,,0,0,0,,If you make it a circular matrix, if you put things here and here, you get...
Dialogue: 0,00:03:12.220,00:03:15.820,辉英,,0,0,0,,You get periodic boundary conditions.
Dialogue: 0,00:03:16.520,00:03:17.020,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:17.120,00:03:18.420,辉英,,0,0,0,,You get a constant.
Dialogue: 0,00:03:18.420,00:03:18.720,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:18.720,00:03:19.720,辉英,,0,0,0,,You get a constant.
Dialogue: 0,00:03:19.720,00:03:19.920,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:19.920,00:03:22.920,辉英,,0,0,0,,So what if u0 is equal to un-1?
Dialogue: 0,00:03:22.920,00:03:28.920,辉英,,0,0,0,,And un is equal to u1, then by adding two numbers here, the right solution.
Dialogue: 0,00:03:28.920,00:03:31.920,辉英,,0,0,0,,.
Dialogue: 0,00:03:31.920,00:03:34.220,辉英,,0,0,0,,What if u0 is equal to 1?
Dialogue: 0,00:03:34.220,00:03:36.620,辉英,,0,0,0,,un is equal to minus 1?
Dialogue: 0,00:03:36.620,00:03:38.720,辉英,,0,0,0,,What do you get?
Dialogue: 0,00:03:38.720,00:03:40.720,辉英,,0,0,0,,How do you modify this equation?
Dialogue: 0,00:03:40.720,00:03:42.720,辉英,,0,0,0,,.
Dialogue: 0,00:03:42.720,00:03:44.720,辉英,,0,0,0,,.
Dialogue: 0,00:03:44.720,00:03:45.120,辉英,,0,0,0,,Yes?
Dialogue: 0,00:03:45.120,00:03:45.820,辉英,,0,0,0,,.
Dialogue: 0,00:03:45.820,00:03:47.780,辉英,,0,0,0,,you could add a constant, exactly.
Dialogue: 0,00:03:48.600,00:03:51.100,辉英,,0,0,0,,So if u0 is equal to a known number,
Dialogue: 0,00:03:52.240,00:03:54.760,辉英,,0,0,0,,that known number is going to be a constant
Dialogue: 0,00:03:54.760,00:03:56.920,辉英,,0,0,0,,that doesn't depend on this vector u.
Dialogue: 0,00:03:57.660,00:04:01.680,辉英,,0,0,0,,So it is going to be this equation plus something.
Dialogue: 0,00:04:03.060,00:04:06.300,辉英,,0,0,0,,And that something has to be a vector, right?
Dialogue: 0,00:04:06.420,00:04:09.080,辉英,,0,0,0,,Has to be a vector of the same length as u.
Dialogue: 0,00:04:10.680,00:04:14.760,辉英,,0,0,0,,And that vector only has to be non-zero for two equations,
Dialogue: 0,00:04:14.760,00:04:16.060,辉英,,0,0,0,,which two are they?
Dialogue: 0,00:04:20.540,00:04:23.960,辉英,,0,0,0,,First and last, we only need to modify the first row and the last row,
Dialogue: 0,00:04:24.080,00:04:25.140,辉英,,0,0,0,,first equation and last equation.
Dialogue: 0,00:04:25.540,00:04:28.840,辉英,,0,0,0,,So starting from the second to the second last, it will be zeros.
Dialogue: 0,00:04:29.820,00:04:37.540,辉英,,0,0,0,,And for the first one, it will be kappa over delta x squared times u0.
Dialogue: 0,00:04:38.220,00:04:44.340,辉英,,0,0,0,,For the last one, it will be kappa over delta x squared times ua.
Dialogue: 0,00:04:44.760,00:04:47.920,辉英,,0,0,0,,Right, these are given numbers, and you know them.
Dialogue: 0,00:04:48.320,00:04:49.900,辉英,,0,0,0,,So this is a constant term.
Dialogue: 0,00:04:51.460,00:04:57.940,辉英,,0,0,0,,At the end, what you get is du dt equal to au plus b.
Dialogue: 0,00:04:58.480,00:05:00.540,辉英,,0,0,0,,Well, a is that matrix, b is that vector.
Dialogue: 0,00:05:02.760,00:05:06.980,辉英,,0,0,0,,That's a standard ODE you can solve using standard methods.
Dialogue: 0,00:05:08.380,00:05:12.380,辉英,,0,0,0,,So this is what we achieve by discretizing the equations.
Dialogue: 0,00:05:13.380,00:05:14.580,辉英,,0,0,0,,What we achieve is...
Dialogue: 0,00:05:14.580,00:05:19.580,辉英,,0,0,0,,We start from a PDE, we approximate the function,
Dialogue: 0,00:05:19.680,00:05:22.480,辉英,,0,0,0,,and we approximate the spatial derivative.
Dialogue: 0,00:05:22.580,00:05:25.580,辉英,,0,0,0,,What we get is an ODE we can solve.
Dialogue: 0,00:05:26.680,00:05:27.680,辉英,,0,0,0,,Yes?
Dialogue: 0,00:05:27.780,00:05:32.080,辉英,,0,0,0,,Do you need to add rows and columns and zeros into the matrix though?
Dialogue: 0,00:05:32.180,00:05:33.180,辉英,,0,0,0,,Or no?
Dialogue: 0,00:05:35.280,00:05:39.280,辉英,,0,0,0,,Do I need to add a row of zeros into the matrix?
Dialogue: 0,00:05:39.380,00:05:40.380,辉英,,0,0,0,,Yes.
Dialogue: 0,00:05:41.280,00:05:43.280,辉英,,0,0,0,,In this case, no.
Dialogue: 0,00:05:43.380,00:05:44.380,辉英,,0,0,0,,Because...
Dialogue: 0,00:05:44.380,00:05:47.180,辉英,,0,0,0,,I want the matrix to be a square matrix.
Dialogue: 0,00:05:48.180,00:05:51.180,辉英,,0,0,0,,du dt has the same length as u.
Dialogue: 0,00:05:51.380,00:05:52.180,辉英,,0,0,0,,Right?
Dialogue: 0,00:05:52.380,00:05:56.180,辉英,,0,0,0,,So the output of the a times u has to be the same length as u.
Dialogue: 0,00:05:56.380,00:05:59.180,辉英,,0,0,0,,Which means the matrix has to be square.
Dialogue: 0,00:06:00.180,00:06:03.180,辉英,,0,0,0,,So here, the matrix is already square.
Dialogue: 0,00:06:03.380,00:06:09.180,辉英,,0,0,0,,You are correct in some other cases when you derive the discretization,
Dialogue: 0,00:06:09.380,00:06:11.180,辉英,,0,0,0,,and the matrix is not square.
Dialogue: 0,00:06:11.380,00:06:14.180,辉英,,0,0,0,,For example, if the solution...
Dialogue: 0,00:06:14.180,00:06:15.980,辉英,,0,0,0,,If the bounded condition is more complex,
Dialogue: 0,00:06:16.180,00:06:18.980,辉英,,0,0,0,,so that u0 and ua is also unknown,
Dialogue: 0,00:06:19.180,00:06:20.980,辉英,,0,0,0,,then after you derive the matrix,
Dialogue: 0,00:06:21.180,00:06:23.980,辉英,,0,0,0,,you may not get a square matrix.
Dialogue: 0,00:06:24.180,00:06:28.980,辉英,,0,0,0,,In that case, you may add rows onto the matrix.
Dialogue: 0,00:06:29.180,00:06:31.980,辉英,,0,0,0,,Maybe not necessarily zero,
Dialogue: 0,00:06:32.180,00:06:34.980,辉英,,0,0,0,,but you need to add rows that behave differently.
Dialogue: 0,00:06:35.180,00:06:37.980,辉英,,0,0,0,,So in this case, we don't have to.
Dialogue: 0,00:06:38.180,00:06:42.980,辉英,,0,0,0,,Because we already derived the time derivative
Dialogue: 0,00:06:42.980,00:06:44.780,辉英,,0,0,0,,of all the unknowns.
Dialogue: 0,00:06:46.980,00:06:47.780,辉英,,0,0,0,,Alright.
Dialogue: 0,00:06:47.980,00:06:51.780,辉英,,0,0,0,,So for example, if you implement this into an ODE solver,
Dialogue: 0,00:06:51.980,00:06:53.780,辉英,,0,0,0,,what you need to do is you need to...
Dialogue: 0,00:06:53.980,00:07:00.780,辉英,,0,0,0,,In MATLAB, you need a function that calculates a times u plus b.
Dialogue: 0,00:07:00.980,00:07:03.780,辉英,,0,0,0,,That's all you need to write.
Dialogue: 0,00:07:03.980,00:07:05.780,辉英,,0,0,0,,You need to precalculate what a is.
Dialogue: 0,00:07:05.980,00:07:07.780,辉英,,0,0,0,,You need to precalculate what b is.
Dialogue: 0,00:07:07.980,00:07:09.780,辉英,,0,0,0,,But in the ODE solver,
Dialogue: 0,00:07:09.980,00:07:12.780,辉英,,0,0,0,,what you are going to be writing is a function that just does that.
Dialogue: 0,00:07:12.980,00:07:13.780,辉英,,0,0,0,,Alright.
Dialogue: 0,00:07:13.980,00:07:15.780,辉英,,0,0,0,,So it's that simple.
Dialogue: 0,00:07:15.980,00:07:20.780,辉英,,0,0,0,,The trick or the math goes into construction of A and construction of B.
