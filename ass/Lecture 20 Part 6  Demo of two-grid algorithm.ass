[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None
PlayResX: 1080
PlayResY: 720

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: 辉英,Tahoma,35,&H00FFFFFF,&H000000FF,&H003B3C3D,&H00000000,0,0,0,0,70,70,1,0,1,1.3,0.2,2,0,0,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,00:00:00.000,00:00:07.000,辉英,,0,0,0,,Okay, so let's show that back in our MATLAB script.
Dialogue: 0,00:00:07.000,00:00:15.000,辉英,,0,0,0,,So here let's make a new function called the multigrid.
Dialogue: 0,00:00:15.000,00:00:21.000,辉英,,0,0,0,,Sorry.
Dialogue: 0,00:00:21.000,00:00:25.000,辉英,,0,0,0,,Okay, thanks.
Dialogue: 0,00:00:25.000,00:00:35.000,辉英,,0,0,0,,So we are trying to make it the same way as we coded up the Jacobi and the Gauss-Seidel iterations.
Dialogue: 0,00:00:35.000,00:00:41.000,辉英,,0,0,0,,So the start is we are computing the residual, right?
Dialogue: 0,00:00:41.000,00:00:47.000,辉英,,0,0,0,,So the residual, first of all, is going to be...
Dialogue: 0,00:00:47.000,00:00:53.000,辉英,,0,0,0,,Let's actually first do the same thing to compute delta x again.
Dialogue: 0,00:00:53.000,00:00:55.000,辉英,,0,0,0,,So that's the same thing as what we did.
Dialogue: 0,00:00:55.000,00:01:03.000,辉英,,0,0,0,,And the residual is going to be...
Dialogue: 0,00:01:03.000,00:01:09.000,辉英,,0,0,0,,The residual of the Laplace equation.
Dialogue: 0,00:01:09.000,00:01:15.000,辉英,,0,0,0,,So the residual is going to be the b minus...
Dialogue: 0,00:01:15.000,00:01:18.000,辉英,,0,0,0,,Okay, so let's first make it equal to b.
Dialogue: 0,00:01:18.000,00:01:22.000,辉英,,0,0,0,,And for i goes from 2 to n interval.
Dialogue: 0,00:01:22.000,00:01:24.000,辉英,,0,0,0,,For j goes from 2 to n interval.
Dialogue: 0,00:01:24.000,00:01:25.000,辉英,,0,0,0,,Okay.
Dialogue: 0,00:01:25.000,00:01:35.000,辉英,,0,0,0,,So for the interval, we are going to say the residual ij is equal to residual...
Dialogue: 0,00:01:35.000,00:01:38.000,辉英,,0,0,0,,Let's make it clearer.
Dialogue: 0,00:01:38.000,00:01:42.000,辉英,,0,0,0,,Let's do zeros.
Dialogue: 0,00:01:42.000,00:01:44.000,辉英,,0,0,0,,Size of b.
Dialogue: 0,00:01:44.000,00:01:52.000,辉英,,0,0,0,,So rij would be equal to the right-hand side, which is bij, minus the Poisson's equation,
Dialogue: 0,00:01:52.000,00:01:54.000,辉英,,0,0,0,,which is u0.
Dialogue: 0,00:01:54.000,00:02:11.000,辉英,,0,0,0,,So we have u0 of i minus 1j plus u0 of i plus 1j plus u0 of ij minus 1 plus u0 of ij plus 1.
Dialogue: 0,00:02:11.000,00:02:21.000,辉英,,0,0,0,,We have to minus 4 times u0 ij divided by delta x squared.
Dialogue: 0,00:02:21.000,00:02:22.000,辉英,,0,0,0,,Right?
Dialogue: 0,00:02:22.000,00:02:30.000,辉英,,0,0,0,,So we have...
Dialogue: 0,00:02:30.000,00:02:35.000,辉英,,0,0,0,,We have the right-hand side minus the left-hand side of the Poisson's equation.
Dialogue: 0,00:02:35.000,00:02:41.000,辉英,,0,0,0,,So b minus the second-order derivative of u in both x and y directions.
Dialogue: 0,00:02:41.000,00:02:43.000,辉英,,0,0,0,,Right?
Dialogue: 0,00:02:43.000,00:02:45.000,辉英,,0,0,0,,Okay.
Dialogue: 0,00:02:45.000,00:02:49.000,辉英,,0,0,0,,So that is our residual calculation.
Dialogue: 0,00:02:49.000,00:02:51.000,辉英,,0,0,0,,And...
Dialogue: 0,00:02:51.000,00:02:59.000,辉英,,0,0,0,,Once we have the residual calculation, we want to interpolate this to a cos grid.
Dialogue: 0,00:02:59.000,00:03:05.000,辉英,,0,0,0,,Oh, no. Cos.
Dialogue: 0,00:03:05.000,00:03:10.000,辉英,,0,0,0,,So our interpolation to the cos grid would be something like that.
Dialogue: 0,00:03:10.000,00:03:13.000,辉英,,0,0,0,,So we should have R...
Dialogue: 0,00:03:13.000,00:03:17.000,辉英,,0,0,0,,Let's call it RC is equal to...
Dialogue: 0,00:03:17.000,00:03:20.000,辉英,,0,0,0,,Uh...
Dialogue: 0,00:03:20.000,00:03:23.000,辉英,,0,0,0,,I think we'll do exactly what you mentioned.
Dialogue: 0,00:03:23.000,00:03:30.000,辉英,,0,0,0,,We will make a cos grid that is exactly twice as cos as the fine grid.
Dialogue: 0,00:03:30.000,00:03:40.000,辉英,,0,0,0,,So it'll be zeros and interval divided by 2 plus 1.
Dialogue: 0,00:03:40.000,00:03:42.000,辉英,,0,0,0,,So I still need the boundary conditions.
Dialogue: 0,00:03:42.000,00:03:48.000,辉英,,0,0,0,,And the RC of 2, 2 and minus 1.
Dialogue: 0,00:03:48.000,00:03:50.000,辉英,,0,0,0,,2, 2 and minus 1.
Dialogue: 0,00:03:50.000,00:03:52.000,辉英,,0,0,0,,Would be a copy of my R.
Dialogue: 0,00:03:52.000,00:03:54.000,辉英,,0,0,0,,So...
Dialogue: 0,00:03:54.000,00:03:56.000,辉英,,0,0,0,,So let's see.
Dialogue: 0,00:03:56.000,00:03:58.000,辉英,,0,0,0,,How should I perform that copying?
Dialogue: 0,00:03:58.000,00:04:00.000,辉英,,0,0,0,,I have a fine grid.
Dialogue: 0,00:04:00.000,00:04:02.000,辉英,,0,0,0,,Like this.
Dialogue: 0,00:04:02.000,00:04:04.000,辉英,,0,0,0,,1, 2, 3, 4, 5, 6.
Dialogue: 0,00:04:04.000,00:04:07.000,辉英,,0,0,0,,And I want a cos grid that is twice as cos.
Dialogue: 0,00:04:07.000,00:04:09.000,辉英,,0,0,0,,So cos grid would be like that.
Dialogue: 0,00:04:09.000,00:04:12.000,辉英,,0,0,0,,So the cos grid starting from 95,
Dialogue: 0,00:04:12.000,00:04:14.000,辉英,,0,0,0,,and then the cos grid starting from 95,
Dialogue: 0,00:04:14.000,00:04:16.000,辉英,,0,0,0,,and then the cos grid starting from 95,
Dialogue: 0,00:04:16.000,00:04:22.000,辉英,,0,0,0,,so the cos grid starting from number 2 should be the fine grid starting from number 3.
Dialogue: 0,00:04:22.000,00:04:23.000,辉英,,0,0,0,,Right?
Dialogue: 0,00:04:23.000,00:04:29.000,辉英,,0,0,0,,So I should be 3, 2 and minus 2.
Dialogue: 0,00:04:29.000,00:04:33.000,辉英,,0,0,0,,3, 2 and minus 2.
Dialogue: 0,00:04:33.000,00:04:35.000,辉英,,0,0,0,,So the second number here is the...
Dialogue: 0,00:04:35.000,00:04:38.000,辉英,,0,0,0,,I'm gonna skip one.
Dialogue: 0,00:04:38.000,00:04:41.000,辉英,,0,0,0,,I'm taking every two values.
Dialogue: 0,00:04:41.000,00:04:42.000,辉英,,0,0,0,,Yes?
Dialogue: 0,00:04:42.000,00:04:44.000,辉英,,0,0,0,,Minus 2.
Dialogue: 0,00:04:44.000,00:04:45.000,辉英,,0,0,0,,Minus 2, yeah. Thank you.
Dialogue: 0,00:04:46.000,00:04:48.000,辉英,,0,0,0,,Okay.
Dialogue: 0,00:04:48.000,00:04:52.000,辉英,,0,0,0,,So now I have the interpolation to the cos grid.
Dialogue: 0,00:04:52.000,00:04:54.000,辉英,,0,0,0,,On the cos grid,
Dialogue: 0,00:04:54.000,00:04:56.000,辉英,,0,0,0,,I want to solve...
Dialogue: 0,00:04:56.000,00:05:01.000,辉英,,0,0,0,,perform iterations on the cos grid.
Dialogue: 0,00:05:06.000,00:05:12.000,辉英,,0,0,0,,So it's usually good just to perform a few iterations.
Dialogue: 0,00:05:12.000,00:05:14.000,辉英,,0,0,0,,So let's make a cos grid,
Dialogue: 0,00:05:14.000,00:05:15.000,辉英,,0,0,0,,dx,
Dialogue: 0,00:05:15.000,00:05:17.000,辉英,,0,0,0,,du.
Dialogue: 0,00:05:17.000,00:05:19.000,辉英,,0,0,0,,So that's the correction on u is...
Dialogue: 0,00:05:19.000,00:05:21.000,辉英,,0,0,0,,Let's do zeros.
Dialogue: 0,00:05:21.000,00:05:25.000,辉英,,0,0,0,,The size of RC.
Dialogue: 0,00:05:25.000,00:05:28.000,辉英,,0,0,0,,So we'll make initial guess equal to zeros.
Dialogue: 0,00:05:28.000,00:05:32.000,辉英,,0,0,0,,And let's do 10 iterations.
Dialogue: 0,00:05:32.000,00:05:35.000,辉英,,0,0,0,,And let's use the Gauss-Seidel iterations.
Dialogue: 0,00:05:35.000,00:05:41.000,辉英,,0,0,0,,So du is equal to Gauss-Seidel of du and my RC.
Dialogue: 0,00:05:41.000,00:05:43.000,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:43.000,00:05:44.000,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:44.000,00:05:46.000,辉英,,0,0,0,,And afterwards,
Dialogue: 0,00:05:46.000,00:05:51.000,辉英,,0,0,0,,I'm going to interpolate the du to fine grid.
Dialogue: 0,00:05:51.000,00:05:53.000,辉英,,0,0,0,,So here I want to interpolate R,
Dialogue: 0,00:05:53.000,00:05:55.000,辉英,,0,0,0,,the residual to the cos grid.
Dialogue: 0,00:05:55.000,00:05:56.000,辉英,,0,0,0,,Fine grid.
Dialogue: 0,00:05:56.000,00:05:59.000,辉英,,0,0,0,,So interpolating the correction to the fine grid.
Dialogue: 0,00:06:01.000,00:06:03.000,辉英,,0,0,0,,So duf,
Dialogue: 0,00:06:03.000,00:06:04.000,辉英,,0,0,0,,that's my fine grid,
Dialogue: 0,00:06:04.000,00:06:07.000,辉英,,0,0,0,,is equal to zeros,
Dialogue: 0,00:06:07.000,00:06:09.000,辉英,,0,0,0,,the size of B here.
Dialogue: 0,00:06:11.000,00:06:13.000,辉英,,0,0,0,,And here I really need interpolation.
Dialogue: 0,00:06:13.000,00:06:22.000,辉英,,0,0,0,,Because my cos grid is only a fraction of the grids I have on the fine grid.
Dialogue: 0,00:06:22.000,00:06:28.000,辉英,,0,0,0,,So duf does have some places where I don't need interpolation.
Dialogue: 0,00:06:28.000,00:06:33.000,辉英,,0,0,0,,So these are the same points where I can just copy the values from du.
Dialogue: 0,00:06:33.000,00:06:41.000,辉英,,0,0,0,,2 to n, 2 to n minus 1, 2 to n minus 1.
Dialogue: 0,00:06:41.000,00:06:42.000,辉英,,0,0,0,,Right.
Dialogue: 0,00:06:42.000,00:06:47.000,辉英,,0,0,0,,So these are the places I can perform my copying.
Dialogue: 0,00:06:47.000,00:06:49.000,辉英,,0,0,0,,And afterwards,
Dialogue: 0,00:06:49.000,00:06:54.000,辉英,,0,0,0,,I can just do a linear interpolation in both x and y directions.
Dialogue: 0,00:06:54.000,00:06:55.000,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:55.000,00:07:00.000,辉英,,0,0,0,,So first let's do a linear interpolation in the x direction.
Dialogue: 0,00:07:00.000,00:07:06.000,辉英,,0,0,0,,So that would be if I start from 2 to 2 to n minus 1.
Dialogue: 0,00:07:06.000,00:07:13.000,辉英,,0,0,0,,I still have the same values here.
Dialogue: 0,00:07:13.000,00:07:17.000,辉英,,0,0,0,,Would be equal to 0.5 times the average,
Dialogue: 0,00:07:17.000,00:07:21.000,辉英,,0,0,0,,that would be the average between the neighboring values.
Dialogue: 0,00:07:21.000,00:07:33.000,辉英,,0,0,0,,So would be the average between 1 to 2 to n minus 2,
Dialogue: 0,00:07:33.000,00:07:35.000,辉英,,0,0,0,,which is,
Dialogue: 0,00:07:35.000,00:07:39.000,辉英,,0,0,0,,includes both the boundary value 0 at r equal to 1,
Dialogue: 0,00:07:39.000,00:07:45.000,辉英,,0,0,0,,and all the other values I have already copied from the du on the cos grid.
Dialogue: 0,00:07:50.000,00:07:53.000,辉英,,0,0,0,,And plus
Dialogue: 0,00:07:58.000,00:08:04.000,辉英,,0,0,0,,my duf at now 3 to 2 to n.
Dialogue: 0,00:08:05.000,00:08:12.000,辉英,,0,0,0,,So this is my interpolation in the x direction.
Dialogue: 0,00:08:12.000,00:08:17.000,辉英,,0,0,0,,So now I have all the values at every i direction,
Dialogue: 0,00:08:17.000,00:08:18.000,辉英,,0,0,0,,at all the i directions,
Dialogue: 0,00:08:18.000,00:08:23.000,辉英,,0,0,0,,but at every other j direction I want to interpolate in the j direction.
Dialogue: 0,00:08:23.000,00:08:26.000,辉英,,0,0,0,,So duf,
Dialogue: 0,00:08:26.000,00:08:29.000,辉英,,0,0,0,,now every j direction is filled.
Dialogue: 0,00:08:29.000,00:08:34.000,辉英,,0,0,0,,2 to 2 to n minus 1 in the j direction is,
Dialogue: 0,00:08:34.000,00:08:36.000,辉英,,0,0,0,,I want to follow the same formula,
Dialogue: 0,00:08:36.000,00:08:38.000,辉英,,0,0,0,,duf,
Dialogue: 0,00:08:38.000,00:08:42.000,辉英,,0,0,0,,colon, 1 to 2 to n minus 2,
Dialogue: 0,00:08:42.000,00:08:43.000,辉英,,0,0,0,,plus duf,
Dialogue: 0,00:08:43.000,00:08:46.000,辉英,,0,0,0,,to 3 to 2 to n.
Dialogue: 0,00:08:50.000,00:08:54.000,辉英,,0,0,0,,Okay, so that completes my interpolation of du to the fine grid.
Dialogue: 0,00:09:00.000,00:09:03.000,辉英,,0,0,0,,Yes, yes, all the i directions, thanks.
Dialogue: 0,00:09:04.000,00:09:13.000,辉英,,0,0,0,,All right, so now I'm going to add a correction to the solution.
Dialogue: 0,00:09:13.000,00:09:20.000,辉英,,0,0,0,,So my u1 is going to be u0 plus duf.
Dialogue: 0,00:09:20.000,00:09:30.000,辉英,,0,0,0,,All right, and I want to do and perform iterations on the fine grid.
Dialogue: 0,00:09:30.000,00:09:36.000,辉英,,0,0,0,,So I'm going to for i goes from 1 to 10.
Dialogue: 0,00:09:36.000,00:09:39.000,辉英,,0,0,0,,I'm going to perform 10 iterations on the fine grid.
Dialogue: 0,00:09:39.000,00:09:44.000,辉英,,0,0,0,,u1 would be equal to gauss, seidel, u1 and my du.
Dialogue: 0,00:09:44.000,00:09:50.000,辉英,,0,0,0,,All right, so that completes my multi-grid,
Dialogue: 0,00:09:50.000,00:09:52.000,辉英,,0,0,0,,I mean two-grid solution.
Dialogue: 0,00:09:52.000,00:09:56.000,辉英,,0,0,0,,All right, so let's try it.
Dialogue: 0,00:09:56.000,00:09:59.000,辉英,,0,0,0,,If we see,
Dialogue: 0,00:09:59.000,00:10:03.000,辉英,,0,0,0,,we have our, let's again make u equal to u0.
Dialogue: 0,00:10:03.000,00:10:09.000,辉英,,0,0,0,,And previously we performed 100 iterations of gauss, seidel,
Dialogue: 0,00:10:09.000,00:10:11.000,辉英,,0,0,0,,and we saw what we had, right?
Dialogue: 0,00:10:11.000,00:10:16.000,辉英,,0,0,0,,So in here, because we have 20 iterations on the coarse grid,
Dialogue: 0,00:10:16.000,00:10:18.000,辉英,,0,0,0,,20 iterations on the fine grid.
Dialogue: 0,00:10:18.000,00:10:20.000,辉英,,0,0,0,,So let's only do 5 iterations.
Dialogue: 0,00:10:23.000,00:10:28.000,辉英,,0,0,0,,Let's say u is equal to multi-grid of u and b.
Dialogue: 0,00:10:29.000,00:10:34.000,辉英,,0,0,0,,Okay, now I get my u.
Dialogue: 0,00:10:34.000,00:10:39.000,辉英,,0,0,0,,Let's look at what u looks like here.
Dialogue: 0,00:10:39.000,00:10:45.000,辉英,,0,0,0,,Okay, so do you see some difference between the solution I get
Dialogue: 0,00:10:45.000,00:10:47.000,辉英,,0,0,0,,with 100 gauss, seidel iterations
Dialogue: 0,00:10:47.000,00:10:52.000,辉英,,0,0,0,,and what I get through 5 iterations of multi-grid?
Dialogue: 0,00:10:52.000,00:10:55.000,辉英,,0,0,0,,Let's actually make another image and compare.
Dialogue: 0,00:10:55.000,00:10:57.000,辉英,,0,0,0,,Figure u is equal to u0.
Dialogue: 0,00:10:57.000,00:10:59.000,辉英,,0,0,0,,u is equal to u0.
Dialogue: 0,00:10:59.000,00:11:02.000,辉英,,0,0,0,,And the 4i goes from,
Dialogue: 0,00:11:02.000,00:11:06.000,辉英,,0,0,0,,let's just copy the code I think I had before.
Dialogue: 0,00:11:14.000,00:11:19.000,辉英,,0,0,0,,Title gauss, seidel, 100 iterations.
Dialogue: 0,00:11:23.000,00:11:26.000,辉英,,0,0,0,,So this is gauss, seidel after 100 iterations.
Dialogue: 0,00:11:26.000,00:11:29.000,辉英,,0,0,0,,This is my multi-grid after 5 iterations,
Dialogue: 0,00:11:29.000,00:11:34.000,辉英,,0,0,0,,which includes 50 coarse-grid iterations and 50 fine-grid iterations.
Dialogue: 0,00:11:37.000,00:11:39.000,辉英,,0,0,0,,Do you see some difference or not?
Dialogue: 0,00:11:40.000,00:11:41.000,辉英,,0,0,0,,Yes.
Dialogue: 0,00:11:41.000,00:11:45.000,辉英,,0,0,0,,So the gauss, seidel iterations looks very,
Dialogue: 0,00:11:45.000,00:11:47.000,辉英,,0,0,0,,only has very fine lines,
Dialogue: 0,00:11:47.000,00:11:53.000,辉英,,0,0,0,,and the multi-grid has a lot more smoothness, right?
Dialogue: 0,00:11:53.000,00:11:55.000,辉英,,0,0,0,,It has a lot more lower frequency content in it.
Dialogue: 0,00:11:55.000,00:12:01.000,辉英,,0,0,0,,That probably means that there are some lower frequency content
Dialogue: 0,00:12:01.000,00:12:05.000,辉英,,0,0,0,,in the solution that starts to converge faster in the multi-grid
Dialogue: 0,00:12:05.000,00:12:07.000,辉英,,0,0,0,,than in the gauss, seidel, right?
