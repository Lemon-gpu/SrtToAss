[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None
PlayResX: 1080
PlayResY: 720

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: 辉英,Tahoma,35,&H00FFFFFF,&H000000FF,&H003B3C3D,&H00000000,0,0,0,0,70,70,1,0,1,1.3,0.2,2,0,0,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,00:00:00.000,00:00:06.280,辉英,,0,0,0,,So that promotes the fact that like the coarse grid iterations are almost free
Dialogue: 0,00:00:06.280,00:00:15.240,辉英,,0,0,0,,in 3D, promotes the use of this so-called W cycle. Okay, in 1D it doesn't, it makes
Dialogue: 0,00:00:15.240,00:00:21.660,辉英,,0,0,0,,more sense to perform the V cycle as we did before. So this looks like a V. The
Dialogue: 0,00:00:21.660,00:00:29.420,辉英,,0,0,0,,W cycle, it looks pretty complicated because on every, so basically it
Dialogue: 0,00:00:29.420,00:00:36.140,辉英,,0,0,0,,replicates this by effect of two and then on every V it replicates this by
Dialogue: 0,00:00:36.140,00:00:40.340,辉英,,0,0,0,,effect of two, right? So that looks like, that's what makes it looks like a W.
Dialogue: 0,00:00:40.340,00:00:47.560,辉英,,0,0,0,,But if you think of in the code, this is very easy to do. If I want to perform a
Dialogue: 0,00:00:47.560,00:00:50.220,辉英,,0,0,0,,W cycle, what do I do?
Dialogue: 0,00:00:50.220,00:00:51.560,辉英,,0,0,0,,The only thing I do is I just, I just do this.
Dialogue: 0,00:00:51.560,00:00:51.640,辉英,,0,0,0,,The only thing I do is I just do this. The only thing I do is I just do this.
Dialogue: 0,00:00:51.640,00:01:02.620,辉英,,0,0,0,,The only thing I need to do is that. Okay, so that would be a W cycle. I'm performing two
Dialogue: 0,00:01:02.620,00:01:11.980,辉英,,0,0,0,,multi-grid iterations when I'm going to a coarser grid, right? So this is at the
Dialogue: 0,00:01:11.980,00:01:17.440,辉英,,0,0,0,,finest grid, I'm going to the coarser level and this is one call to this
Dialogue: 0,00:01:17.440,00:01:21.540,辉英,,0,0,0,,multi-grid. This is my second call.
Dialogue: 0,00:01:21.540,00:01:29.880,辉英,,0,0,0,,And it is also customary to, so yeah, so this is, so what I was doing is this S is
Dialogue: 0,00:01:29.880,00:01:36.400,辉英,,0,0,0,,performed twice, one pre-smoothing, one post-smoothing in the coarse grid. But like, it doesn't make much difference.
Dialogue: 0,00:01:36.400,00:01:44.420,辉英,,0,0,0,,So this would be one call, the second call to the second finest grid. And when I mean
Dialogue: 0,00:01:44.420,00:01:51.440,辉英,,0,0,0,,multi-grid call of the second finest grid, I'm also making one call and two call.
Dialogue: 0,00:01:51.540,00:01:57.780,辉英,,0,0,0,,To the third finest grid. And so is here.
Dialogue: 0,00:01:57.780,00:02:03.680,辉英,,0,0,0,,So this is a hierarchical, almost like a fractal structure I'm calling here.
Dialogue: 0,00:02:03.680,00:02:11.600,辉英,,0,0,0,,And in the code, this is what I would be doing if I want to use a W cycle multi-grid.
Dialogue: 0,00:02:11.600,00:02:21.440,辉英,,0,0,0,,If you use W cycle multi-grid, well, just to do the same thing here, the result wouldn't
Dialogue: 0,00:02:21.440,00:02:27.680,辉英,,0,0,0,,expect to be a lot more different from just the V cycle. It's probably a little bit better.
Dialogue: 0,00:02:27.680,00:02:34.960,辉英,,0,0,0,,But remember, the coarser grid solution is almost free, right?
Dialogue: 0,00:02:34.960,00:02:41.080,辉英,,0,0,0,,And in 1D, let's take a look at the cost analysis of the W cycle.
Dialogue: 0,00:02:41.080,00:02:49.080,辉英,,0,0,0,,So in 1D, it doesn't make that much sense to do the W cycle multi-grid as I just did
Dialogue: 0,00:02:49.080,00:02:50.680,辉英,,0,0,0,,before.
Dialogue: 0,00:02:50.680,00:03:05.460,辉英,,0,0,0,,Because the cost of the cost of n grid point, if I keep doing this, would be proportional
Dialogue: 0,00:03:05.460,00:03:09.720,辉英,,0,0,0,,to n plus two times the cost.
Dialogue: 0,00:03:09.720,00:03:13.200,辉英,,0,0,0,,So this is the iterations I perform on this grid.
Dialogue: 0,00:03:13.200,00:03:18.920,辉英,,0,0,0,,Two times the cost of the coarser grid.
Dialogue: 0,00:03:18.920,00:03:19.920,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:19.920,00:03:20.440,辉英,,0,0,0,,Okay.
Dialogue: 0,00:03:20.680,00:03:29.300,辉英,,0,0,0,,And if the cost of this, if I perform that iteratively, that'll be two times n over
Dialogue: 0,00:03:29.300,00:03:35.440,辉英,,0,0,0,,two plus two times the cost of n over four.
Dialogue: 0,00:03:35.440,00:03:36.920,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:36.920,00:03:41.040,辉英,,0,0,0,,Oh, I shouldn't be...
Dialogue: 0,00:03:41.040,00:03:42.040,辉英,,0,0,0,,Right.
Dialogue: 0,00:03:42.040,00:03:44.160,辉英,,0,0,0,,So, okay.
Dialogue: 0,00:03:44.160,00:03:48.980,辉英,,0,0,0,,If I keep doing this, this will be n plus n plus n plus et cetera.
Dialogue: 0,00:03:48.980,00:03:49.980,辉英,,0,0,0,,So the...
Dialogue: 0,00:03:49.980,00:03:50.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:03:50.480,00:03:51.480,辉英,,0,0,0,,So the cost is going to be proportional to the number of levels.
Dialogue: 0,00:03:51.480,00:03:56.480,辉英,,0,0,0,,However many levels you have in the multi-grid, the cost is going to be proportional to the
Dialogue: 0,00:03:56.480,00:04:01.200,辉英,,0,0,0,,number of levels instead of bounded by a factor of two.
Dialogue: 0,00:04:01.200,00:04:06.720,辉英,,0,0,0,,But starting from 2D, this makes a lot more sense.
Dialogue: 0,00:04:06.720,00:04:17.200,辉英,,0,0,0,,Because in 2D, the cost of n total grid points is equal to n plus two times the cost of n
Dialogue: 0,00:04:17.200,00:04:18.280,辉英,,0,0,0,,over four.
Dialogue: 0,00:04:18.280,00:04:19.280,辉英,,0,0,0,,Okay?
Dialogue: 0,00:04:19.280,00:04:20.280,辉英,,0,0,0,,Right?
Dialogue: 0,00:04:20.280,00:04:27.280,辉英,,0,0,0,,So, if I do this iteratively, I'm going to get n plus n plus n plus n plus n plus n plus
Dialogue: 0,00:04:27.280,00:04:33.280,辉英,,0,0,0,,n plus n plus n plus n plus n plus n plus n plus n plus n plus n plus n plus n plus n plus n
Dialogue: 0,00:04:33.280,00:04:37.520,辉英,,0,0,0,,n over four plus two times the cost of n over sixteen.
Dialogue: 0,00:04:37.520,00:04:45.600,辉英,,0,0,0,,And if you expand this, it'll be n plus half n plus a fourth n, et cetera.
Dialogue: 0,00:04:45.600,00:04:47.280,辉英,,0,0,0,,So it's the same as our one-dimensional V-cycle cost.
Dialogue: 0,00:04:47.280,00:04:48.280,辉英,,0,0,0,,Okay?
Dialogue: 0,00:04:48.280,00:04:49.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:04:49.280,00:04:50.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:04:50.280,00:04:51.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:04:51.280,00:04:55.280,辉英,,0,0,0,,This is less or equal to, I mean, strictly less than 2n.
Dialogue: 0,00:04:55.280,00:04:56.280,辉英,,0,0,0,,Right?
Dialogue: 0,00:04:56.280,00:05:04.280,辉英,,0,0,0,,So, doing a multi-grid cycle in 2D is you're going to get a cost that is bounded by twice
Dialogue: 0,00:05:04.280,00:05:08.920,辉英,,0,0,0,,the cost of the fine-grid operation.
Dialogue: 0,00:05:08.920,00:05:17.360,辉英,,0,0,0,,And in 3D, it makes a lot of sense to do the multi-grid because the cost of n is going
Dialogue: 0,00:05:17.360,00:05:19.280,辉英,,0,0,0,,to be n plus two times n.
Dialogue: 0,00:05:19.280,00:05:20.280,辉英,,0,0,0,,So, if you do the math, it'll be the same series as the two-dimensional V-cycle.
Dialogue: 0,00:05:20.280,00:05:21.280,辉英,,0,0,0,,This is going to be strictly less than 4 over 3 times n.
Dialogue: 0,00:05:21.280,00:05:22.280,辉英,,0,0,0,,Right?
Dialogue: 0,00:05:22.280,00:05:23.280,辉英,,0,0,0,,So, even doing the multi-grid cycle, you're going to get a cost that is going to be less
Dialogue: 0,00:05:23.280,00:05:24.280,辉英,,0,0,0,,than 4 over 3 times n.
Dialogue: 0,00:05:24.280,00:05:25.280,辉英,,0,0,0,,Okay?
Dialogue: 0,00:05:25.280,00:05:26.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:26.280,00:05:27.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:27.280,00:05:28.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:28.280,00:05:29.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:29.280,00:05:30.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:30.280,00:05:31.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:31.280,00:05:32.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:32.280,00:05:33.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:33.280,00:05:34.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:34.280,00:05:35.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:35.280,00:05:36.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:36.280,00:05:37.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:37.280,00:05:38.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:38.280,00:05:39.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:39.280,00:05:40.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:40.280,00:05:41.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:41.280,00:05:42.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:42.280,00:05:43.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:43.280,00:05:44.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:44.280,00:05:45.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:45.280,00:05:46.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:46.280,00:05:47.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:47.280,00:05:48.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:48.280,00:05:49.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:49.280,00:05:50.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:50.280,00:05:51.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:51.280,00:05:52.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:52.280,00:05:53.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:53.280,00:05:54.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:54.280,00:05:55.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:55.280,00:05:56.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:56.280,00:05:57.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:57.280,00:05:58.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:58.280,00:05:59.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:05:59.280,00:06:00.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:00.280,00:06:01.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:02.280,00:06:03.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:03.280,00:06:04.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:04.280,00:06:05.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:05.280,00:06:06.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:06.280,00:06:07.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:07.280,00:06:08.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:08.280,00:06:09.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:09.280,00:06:10.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:10.280,00:06:11.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:11.280,00:06:12.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:12.280,00:06:13.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:13.280,00:06:14.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:14.280,00:06:15.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:15.280,00:06:16.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:16.280,00:06:17.280,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:17.280,00:06:24.720,辉英,,0,0,0,,even cheaper. You can imagine. Yes, this is the reason they put gamma here. I copied
Dialogue: 0,00:06:24.720,00:06:33.960,辉英,,0,0,0,,this from another lecture notes is because they basically have a loop
Dialogue: 0,00:06:33.960,00:06:41.940,辉英,,0,0,0,,here. So for gamma goes from 1 to 2, you do that. Right, so that's the
Dialogue: 0,00:06:41.940,00:06:50.220,辉英,,0,0,0,,gamma you would be having in the plot. So you are iterating here and this is
Dialogue: 0,00:06:50.220,00:07:01.220,辉英,,0,0,0,,what the gamma shows. Alright, so it's a yeah. Any other questions? And you can do
Dialogue: 0,00:07:01.220,00:07:06.260,辉英,,0,0,0,,a super W cycle if you make gamma goes from 1 to 3, for example. I don't see
Dialogue: 0,00:07:06.260,00:07:11.900,辉英,,0,0,0,,anybody doing that in fact, but like can probably do that.
Dialogue: 0,00:07:11.940,00:07:21.940,辉英,,0,0,0,,Okay, but I do see a lot of people doing this. So this is what people call a full
Dialogue: 0,00:07:21.940,00:07:31.180,辉英,,0,0,0,,multigrid. It is motivated by the fact that an initial guess is actually
Dialogue: 0,00:07:31.180,00:07:38.160,辉英,,0,0,0,,pretty important for the convergence of many problems. And for linear problems,
Dialogue: 0,00:07:38.160,00:07:41.820,辉英,,0,0,0,,it's relatively easy to do.
Dialogue: 0,00:07:41.940,00:07:46.620,辉英,,0,0,0,,It's not that difficult to just use a zero initial guess and especially for
Dialogue: 0,00:07:46.620,00:07:51.120,辉英,,0,0,0,,nonlinear problems, it's very important to have a good initial guess. So what
Dialogue: 0,00:07:51.120,00:07:57.120,辉英,,0,0,0,,this does is that instead of starting from the finest grid, you
Dialogue: 0,00:07:57.120,00:08:02.780,辉英,,0,0,0,,start from the closest grid. And on the closest grid, you don't start solving the
Dialogue: 0,00:08:02.780,00:08:06.840,辉英,,0,0,0,,error equation because you don't have the residual from the fine grid. You
Dialogue: 0,00:08:06.840,00:08:11.180,辉英,,0,0,0,,start by solving the equation, the partial differential equation itself on
Dialogue: 0,00:08:11.180,00:08:17.360,辉英,,0,0,0,,the closest grid. And then you perform an interpolation. They call prolongation, so
Dialogue: 0,00:08:17.360,00:08:21.860,辉英,,0,0,0,,restriction and prolongation is the technical terminology they use in
Dialogue: 0,00:08:21.860,00:08:26.660,辉英,,0,0,0,,multigrid, representing these two interpolations. So prolongation is
Dialogue: 0,00:08:26.660,00:08:31.820,辉英,,0,0,0,,interpolating from cost, interpolating the solution from cost to fine grid.
Dialogue: 0,00:08:31.820,00:08:38.120,辉英,,0,0,0,,Restriction is interpolating the residual from fine to cost grid. Right, this is
Dialogue: 0,00:08:38.120,00:08:41.040,辉英,,0,0,0,,always what you'll be doing. So in the
Dialogue: 0,00:08:41.180,00:08:45.360,辉英,,0,0,0,,prolongation, interpolate the solution from the cost to fine grid. And that solution is
Dialogue: 0,00:08:45.360,00:08:52.700,辉英,,0,0,0,,used as an initial guess for the finer grid. So this is then performing one V
Dialogue: 0,00:08:52.700,00:09:00.320,辉英,,0,0,0,,cycle on the second closest grid. And that solution is going to be used as an
Dialogue: 0,00:09:00.320,00:09:04.720,辉英,,0,0,0,,initial guess. The interpolated solution is then used as the initial guess for the
Dialogue: 0,00:09:04.720,00:09:10.860,辉英,,0,0,0,,third closest grid. And then performing one iteration on the closest grid, you
Dialogue: 0,00:09:10.860,00:09:18.960,辉英,,0,0,0,,would get initial guess for the finest grid. Also, you don't have to do exactly
Dialogue: 0,00:09:18.960,00:09:25.560,辉英,,0,0,0,,one V cycle before you jump to the final grid. So this is a customary of what
Dialogue: 0,00:09:25.560,00:09:32.620,辉英,,0,0,0,,people have been using for full multigrid. And you start solving, for
Dialogue: 0,00:09:32.620,00:09:40.020,辉英,,0,0,0,,example, a 13 by 7 problem performing one, two, three, four, five multigrid cycles,
Dialogue: 0,00:09:40.860,00:09:48.260,辉英,,0,0,0,,as an initial guess for the final grid. So you perform a few iterations, a few
Dialogue: 0,00:09:48.260,00:09:53.740,辉英,,0,0,0,,multigrid cycles on the second closest grid as an initial condition for the next
Dialogue: 0,00:09:53.740,00:10:02.560,辉英,,0,0,0,,final grid. So here, every point is one multigrid cycle. And basically because,
Dialogue: 0,00:10:02.560,00:10:09.060,辉英,,0,0,0,,especially for 3D problems, these closest grid iterations are
Dialogue: 0,00:10:09.060,00:10:10.760,辉英,,0,0,0,,almost free for you.
Dialogue: 0,00:10:10.860,00:10:19.560,辉英,,0,0,0,,Right? So it's a, you can converge these closest grid solutions to pretty small residual
Dialogue: 0,00:10:19.560,00:10:25.100,辉英,,0,0,0,,and use that as an initial guess for the final grid. Yes?
Dialogue: 0,00:10:25.100,00:10:30.240,辉英,,0,0,0,,Why does the residual norm go back up?
Dialogue: 0,00:10:30.240,00:10:38.860,辉英,,0,0,0,,Why does the residual norm goes back up as you start a final grid solution? What do you
Dialogue: 0,00:10:38.860,00:10:39.860,辉英,,0,0,0,,think? Any people?
Dialogue: 0,00:10:39.860,00:10:40.860,辉英,,0,0,0,,Yeah.
Dialogue: 0,00:10:40.860,00:10:49.620,辉英,,0,0,0,,Take a guess. Huh? Interpolation, exactly. Because at here, this is the, this residual
Dialogue: 0,00:10:49.620,00:10:56.760,辉英,,0,0,0,,is different from this residual. This residual is the residual of a different equation, of
Dialogue: 0,00:10:56.760,00:11:03.640,辉英,,0,0,0,,the equation on the cost grid. While this residual is the residual of a final grid equation.
Dialogue: 0,00:11:03.640,00:11:08.360,辉英,,0,0,0,,I mean, if you look at this, this is at the same point. So this is the same solution,
Dialogue: 0,00:11:08.360,00:11:10.740,辉英,,0,0,0,,just interpolated to the final grid.
Dialogue: 0,00:11:10.860,00:11:17.400,辉英,,0,0,0,,I'm evaluating the solution on a different mesh, on a different equation, different discretization.
