[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None
PlayResX: 1080
PlayResY: 720

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: 辉英,Tahoma,35,&H00FFFFFF,&H000000FF,&H003B3C3D,&H00000000,0,0,0,0,70,70,1,0,1,1.3,0.2,2,0,0,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,00:00:00.000,00:00:05.380,辉英,,0,0,0,,So last lecture we started the general formulation of finite volume schemes.
Dialogue: 0,00:00:06.000,00:00:11.880,辉英,,0,0,0,,So we store the cell averages, ui is equal to 1 over delta x,
Dialogue: 0,00:00:12.280,00:00:20.320,辉英,,0,0,0,,times the integral from xi minus half and xi plus half of u dx.
Dialogue: 0,00:00:22.560,00:00:28.680,辉英,,0,0,0,,So remember, the first class cities in finite volume is now the cell averages
Dialogue: 0,00:00:28.680,00:00:30.000,辉英,,0,0,0,,and the cells itself.
Dialogue: 0,00:00:30.660,00:00:33.800,辉英,,0,0,0,,The grid points lies in between the cell averages.
Dialogue: 0,00:00:34.500,00:00:41.760,辉英,,0,0,0,,So they are second class citizens and we use the i plus half, i minus half to denote them.
Dialogue: 0,00:00:43.040,00:00:46.780,辉英,,0,0,0,,So this is our definition of ui bar.
Dialogue: 0,00:00:46.780,00:00:51.460,辉英,,0,0,0,,And in the future, in finite volume, I will just use ui to denote them
Dialogue: 0,00:00:51.460,00:00:54.340,辉英,,0,0,0,,because whenever I say ui, it's actually the cell average.
Dialogue: 0,00:00:54.340,00:01:01.560,辉英,,0,0,0,,Okay, so the time derivative of a cell average,
Dialogue: 0,00:01:01.920,00:01:03.860,辉英,,0,0,0,,so I will just say ui equal to this,
Dialogue: 0,00:01:04.200,00:01:14.480,辉英,,0,0,0,,the time derivative of ui is going to be exactly 1 over delta x
Dialogue: 0,00:01:14.480,00:01:20.920,辉英,,0,0,0,,times f of i minus half minus fi plus half.
Dialogue: 0,00:01:21.260,00:01:24.180,辉英,,0,0,0,,This is exact. Again, this is exact.
Dialogue: 0,00:01:24.340,00:01:35.540,辉英,,0,0,0,,This is exact if my f of i plus half is equal to f of u at xi plus half.
Dialogue: 0,00:01:36.080,00:01:38.000,辉英,,0,0,0,,And so is xi minus half.
Dialogue: 0,00:01:38.900,00:01:44.800,辉英,,0,0,0,,The reason finite volume is an approximation is not going to solve the equation exactly
Dialogue: 0,00:01:44.800,00:01:48.920,辉英,,0,0,0,,is because we don't have the value of u at xi plus half.
Dialogue: 0,00:01:49.160,00:01:51.960,辉英,,0,0,0,,We only have the cell averages.
Dialogue: 0,00:01:53.420,00:01:54.320,辉英,,0,0,0,,So we need to...
Dialogue: 0,00:01:54.320,00:02:08.820,辉英,,0,0,0,,We need to approximate f of i plus half from the cell averages.
Dialogue: 0,00:02:12.980,00:02:15.620,辉英,,0,0,0,,Averages of u.
Dialogue: 0,00:02:16.680,00:02:21.840,辉英,,0,0,0,,Okay, so in the last class, we did a central difference type of approximation,
Dialogue: 0,00:02:21.840,00:02:24.180,辉英,,0,0,0,,not central difference, a central average.
Dialogue: 0,00:02:24.320,00:02:25.780,辉英,,0,0,0,,Type of approximation.
Dialogue: 0,00:02:26.560,00:02:30.160,辉英,,0,0,0,,We computed f on the cell average values
Dialogue: 0,00:02:30.160,00:02:34.620,辉英,,0,0,0,,and we just averaged two neighboring cells to get the flux.
Dialogue: 0,00:02:35.640,00:02:41.040,辉英,,0,0,0,,It turns out to be a working scheme before any discontinuity developed.
Dialogue: 0,00:02:42.220,00:02:42.340,辉英,,0,0,0,,Right?
Dialogue: 0,00:02:43.180,00:02:47.460,辉英,,0,0,0,,And after some discontinuity, after a shock wave is developed, what happened?
Dialogue: 0,00:02:51.980,00:02:53.540,辉英,,0,0,0,,Oscillation starts to form.
Dialogue: 0,00:02:54.140,00:02:54.240,辉英,,0,0,0,,Right?
Dialogue: 0,00:02:54.320,00:02:56.180,辉英,,0,0,0,,The solution goes crazy.
Dialogue: 0,00:02:56.700,00:02:58.280,辉英,,0,0,0,,And we didn't want that.
Dialogue: 0,00:02:59.780,00:03:06.240,辉英,,0,0,0,,So today we are going to discuss a very crude way to fix that problem.
Dialogue: 0,00:03:06.700,00:03:08.660,辉英,,0,0,0,,That's called an upwind scheme.
Dialogue: 0,00:03:10.380,00:03:12.560,辉英,,0,0,0,,Okay, so the upwind scheme.
Dialogue: 0,00:03:14.820,00:03:18.660,辉英,,0,0,0,,So it's a way to fix the oscillations.
Dialogue: 0,00:03:18.660,00:03:18.760,辉英,,0,0,0,,Oscillations.
Dialogue: 0,00:03:18.760,00:03:27.160,辉英,,0,0,0,,Around shocks.
Dialogue: 0,00:03:29.640,00:03:29.920,辉英,,0,0,0,,Okay.
Dialogue: 0,00:03:31.200,00:03:37.760,辉英,,0,0,0,,So the motivation of that is still looking at the X-T diagram.
Dialogue: 0,00:03:38.700,00:03:46.580,辉英,,0,0,0,,The X-T diagram is a diagram when we saw on the screen that the characteristics were straight lines.
Dialogue: 0,00:03:46.840,00:03:47.500,辉英,,0,0,0,,Remember that?
Dialogue: 0,00:03:48.760,00:03:52.680,辉英,,0,0,0,,So we see straight lines being characteristics.
Dialogue: 0,00:03:53.640,00:03:54.200,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:54.300,00:03:56.440,辉英,,0,0,0,,And straight lines being characteristics.
Dialogue: 0,00:03:56.880,00:04:01.860,辉英,,0,0,0,,And in between these straight lines, when the straight lines meet, there is a shock wave.
Dialogue: 0,00:04:02.620,00:04:06.880,辉英,,0,0,0,,And the shock wave is not necessarily going to be straight.
Dialogue: 0,00:04:07.100,00:04:08.080,辉英,,0,0,0,,It can curve.
Dialogue: 0,00:04:08.340,00:04:08.460,辉英,,0,0,0,,Right?
Dialogue: 0,00:04:08.520,00:04:11.440,辉英,,0,0,0,,So this is what we see in the X-T diagram.
Dialogue: 0,00:04:13.580,00:04:18.660,辉英,,0,0,0,,In the X-T diagram, and we know that the central difference has problems around the shock wave.
Dialogue: 0,00:04:18.660,00:04:18.720,辉英,,0,0,0,,Right?
Dialogue: 0,00:04:18.720,00:04:18.740,辉英,,0,0,0,,So we know that the central difference has problems around the shock wave.
Dialogue: 0,00:04:18.920,00:04:27.920,辉英,,0,0,0,,So we look around the shock waves to see what is special on the X-T diagram around shock waves.
Dialogue: 0,00:04:29.220,00:04:39.380,辉英,,0,0,0,,It turns out that what's special is that information in the conservation law only propagates in one direction.
Dialogue: 0,00:04:41.040,00:04:45.060,辉英,,0,0,0,,It either propagates towards the left or propagates towards the right.
Dialogue: 0,00:04:46.880,00:04:48.580,辉英,,0,0,0,,And around shock waves,
Dialogue: 0,00:04:48.760,00:04:54.700,辉英,,0,0,0,,information may be propagating in different directions on different sides of the shock wave.
Dialogue: 0,00:04:56.360,00:05:03.180,辉英,,0,0,0,,So the motivation it gives us is that when we compute the flux,
Dialogue: 0,00:05:04.120,00:05:07.860,辉英,,0,0,0,,perhaps we shouldn't be averaging the value at both sides.
Dialogue: 0,00:05:08.220,00:05:14.920,辉英,,0,0,0,,We should be emphasizing one side of the interface more than the other side.
Dialogue: 0,00:05:14.920,00:05:14.940,辉英,,0,0,0,,Right?
Dialogue: 0,00:05:16.280,00:05:18.320,辉英,,0,0,0,,And which side should we emphasize more?
Dialogue: 0,00:05:18.420,00:05:18.740,辉英,,0,0,0,,Which side?
Dialogue: 0,00:05:18.740,00:05:22.020,辉英,,0,0,0,,Which side should we use more information from?
Dialogue: 0,00:05:24.280,00:05:28.180,辉英,,0,0,0,,When we are computing f of i plus half,
Dialogue: 0,00:05:29.280,00:05:38.500,辉英,,0,0,0,,let's say instead of taking the straight average between f of ui and f of ui plus 1,
Dialogue: 0,00:05:38.820,00:05:42.020,辉英,,0,0,0,,let's say if we want to weigh them, one heavier than the other,
Dialogue: 0,00:05:42.380,00:05:44.640,辉英,,0,0,0,,which one should we weigh more?
Dialogue: 0,00:05:46.640,00:05:47.320,辉英,,0,0,0,,Yes?
Dialogue: 0,00:05:47.320,00:05:47.400,辉英,,0,0,0,,Yes?
Dialogue: 0,00:05:48.740,00:05:52.780,辉英,,0,0,0,,Whichever side the wave is coming from.
Dialogue: 0,00:05:53.200,00:05:53.500,辉英,,0,0,0,,Right?
Dialogue: 0,00:05:54.280,00:05:57.120,辉英,,0,0,0,,I want to weigh whichever side is coming from more.
Dialogue: 0,00:05:57.120,00:06:06.120,辉英,,0,0,0,,So an extreme of that is I want to say it is either equal to f ui or f ui plus 1,
Dialogue: 0,00:06:06.320,00:06:10.800,辉英,,0,0,0,,depending on the local speed of characteristics.
Dialogue: 0,00:06:13.600,00:06:13.760,辉英,,0,0,0,,Right?
Dialogue: 0,00:06:14.180,00:06:18.100,辉英,,0,0,0,,So, for example, and we know in a discontinuity,
Dialogue: 0,00:06:18.740,00:06:27.680,辉英,,0,0,0,,let's move it to here, f ui or f ui plus 1.
Dialogue: 0,00:06:28.680,00:06:34.240,辉英,,0,0,0,,The two cases are, we know that if we have a true discontinuity,
Dialogue: 0,00:06:35.100,00:06:39.400,辉英,,0,0,0,,then a shock wave would be forming and moving towards a certain direction.
Dialogue: 0,00:06:39.400,00:06:48.200,辉英,,0,0,0,,And the speed of the shock wave is going to be f of ui minus f of ui plus 1 divided by f ui.
Dialogue: 0,00:06:48.200,00:06:49.200,辉英,,0,0,0,,So, if we have a true discontinuity,
Dialogue: 0,00:06:49.200,00:06:51.200,辉英,,0,0,0,,then we can say that f of ui minus f ui plus 1 divided by ui minus ui plus 1.
Dialogue: 0,00:06:51.200,00:06:59.200,辉英,,0,0,0,,If this one is less than 0, the wave would be moving towards the left,
Dialogue: 0,00:06:59.200,00:07:03.060,辉英,,0,0,0,,in which case we want to use the right.
Dialogue: 0,00:07:03.060,00:07:06.860,辉英,,0,0,0,,So, if it is greater than 0, the wave is moving towards the right,
Dialogue: 0,00:07:06.860,00:07:09.500,辉英,,0,0,0,,and we want to use ui instead of ui plus 1.
Dialogue: 0,00:07:10.020,00:07:10.280,辉英,,0,0,0,,Right?
Dialogue: 0,00:07:10.980,00:07:15.880,辉英,,0,0,0,,And when it is less than 0, we want to use ui plus 1 rather than ui.
Dialogue: 0,00:07:15.980,00:07:16.200,辉英,,0,0,0,,Yes?
Dialogue: 0,00:07:16.200,00:07:17.520,辉英,,0,0,0,,I didn't hear a pal.
Dialogue: 0,00:07:18.200,00:07:24.700,辉英,,0,0,0,,This is by considering there is a discontinuity at x i plus half.
Dialogue: 0,00:07:25.040,00:07:25.280,辉英,,0,0,0,,Yes.
Dialogue: 0,00:07:26.180,00:07:28.040,辉英,,0,0,0,,And in finite volume approximation,
Dialogue: 0,00:07:28.520,00:07:36.820,辉英,,0,0,0,,this way of thinking is to approximate the solution as a piecewise constant function.
Dialogue: 0,00:07:37.540,00:07:37.660,辉英,,0,0,0,,Right?
Dialogue: 0,00:07:37.720,00:07:41.360,辉英,,0,0,0,,This is as if I'm saying, I only have the cell averages.
Dialogue: 0,00:07:42.180,00:07:45.200,辉英,,0,0,0,,How do I reconstruct the solution from the cell averages?
Dialogue: 0,00:07:45.700,00:07:48.200,辉英,,0,0,0,,This is a very crude way of performing.
Dialogue: 0,00:07:48.200,00:07:53.600,辉英,,0,0,0,,That reconstruction is to say, on every cell, the solution is just a uniform constant.
Dialogue: 0,00:07:54.600,00:08:02.060,辉英,,0,0,0,,Then, a small chocolate is going to be, I mean, a big chocolate is going to be formed at every interface.
Dialogue: 0,00:08:03.200,00:08:06.880,辉英,,0,0,0,,And this is how I'm computing the speed of that shockwave.
Dialogue: 0,00:08:07.640,00:08:07.800,辉英,,0,0,0,,Right?
Dialogue: 0,00:08:09.420,00:08:10.060,辉英,,0,0,0,,Okay.
Dialogue: 0,00:08:10.600,00:08:17.200,辉英,,0,0,0,,So, let's implement that scheme to see if that gets rid of our problem.
Dialogue: 0,00:08:18.200,00:08:20.200,辉英,,0,0,0,,Okay.
Dialogue: 0,00:08:20.200,00:08:26.840,辉英,,0,0,0,,And in this case, before we implement that scheme, let's actually simplify this notation a little bit.
Dialogue: 0,00:08:26.900,00:08:35.660,辉英,,0,0,0,,Because if we evaluate this formula, delta f by delta u in brute force, we actually have a problem.
Dialogue: 0,00:08:36.820,00:08:41.660,辉英,,0,0,0,,Because ui can be almost exactly equal to ui plus 1 in some cases.
Dialogue: 0,00:08:42.200,00:08:44.940,辉英,,0,0,0,,And we would be getting something divided by 0.
Dialogue: 0,00:08:45.100,00:08:46.880,辉英,,0,0,0,,I mean, we would get 0 divided by 0.
Dialogue: 0,00:08:46.880,00:08:48.180,辉英,,0,0,0,,Because f of ui is 0.
Dialogue: 0,00:08:48.200,00:08:50.380,辉英,,0,0,0,,It's going to be equal to f of ui plus 1.
Dialogue: 0,00:08:50.500,00:08:52.180,辉英,,0,0,0,,So, 0 divided by 0.
Dialogue: 0,00:08:52.280,00:08:54.560,辉英,,0,0,0,,A computer would get, like, not a number.
Dialogue: 0,00:08:55.620,00:08:57.960,辉英,,0,0,0,,And we'll be screwed after a while.
Dialogue: 0,00:08:57.960,00:09:06.420,辉英,,0,0,0,,So, we want some way to evaluate this ratio without having to encounter a NAND problem.
Dialogue: 0,00:09:07.480,00:09:07.700,辉英,,0,0,0,,Okay.
Dialogue: 0,00:09:08.080,00:09:10.220,辉英,,0,0,0,,So, for example, Berger's equation.
Dialogue: 0,00:09:13.200,00:09:17.500,辉英,,0,0,0,,A simple way to get rid of that is by plugging the formula for f.
Dialogue: 0,00:09:18.200,00:09:21.600,辉英,,0,0,0,,Into that equation.
Dialogue: 0,00:09:21.600,00:09:37.780,辉英,,0,0,0,,So, we are going to get f of ui minus f of ui plus 1 divided by ui minus ui plus 1 would be just equal to half of ui plus ui plus 1.
Dialogue: 0,00:09:37.920,00:09:38.100,辉英,,0,0,0,,Right?
Dialogue: 0,00:09:38.200,00:09:40.680,辉英,,0,0,0,,By plugging the half of u square formula.
Dialogue: 0,00:09:40.680,00:09:43.740,辉英,,0,0,0,,All right.
Dialogue: 0,00:09:44.500,00:09:47.980,辉英,,0,0,0,,So, the upwind.
Dialogue: 0,00:09:48.200,00:09:48.760,辉英,,0,0,0,,Scheme.
Dialogue: 0,00:09:49.340,00:09:50.180,辉英,,0,0,0,,In finite volume.
Dialogue: 0,00:09:51.600,00:09:52.780,辉英,,0,0,0,,Is determining.
Dialogue: 0,00:09:53.200,00:09:58.980,辉英,,0,0,0,,Is looking at the average value of the solution on both sides of the interface.
Dialogue: 0,00:09:58.980,00:10:06.080,辉英,,0,0,0,,And choosing the side to bias according to the average solution in Berger's equation.
Dialogue: 0,00:10:06.780,00:10:08.980,辉英,,0,0,0,,So, let's go to MATLAB.
Dialogue: 0,00:10:10.460,00:10:16.680,辉英,,0,0,0,,And write a new function called ddt upwind.
Dialogue: 0,00:10:18.200,00:10:21.480,辉英,,0,0,0,,And let's do that with a t and u.
Dialogue: 0,00:10:22.160,00:10:23.360,辉英,,0,0,0,,And ddt.
Dialogue: 0,00:10:26.100,00:10:31.800,辉英,,0,0,0,,So, still the first thing to compute is the f bar.
Dialogue: 0,00:10:32.080,00:10:37.320,辉英,,0,0,0,,So, the cell averaged flux is equal to u squared divided by 2.
Dialogue: 0,00:10:38.180,00:10:39.880,辉英,,0,0,0,,So, that's still the same.
Dialogue: 0,00:10:40.680,00:10:40.960,辉英,,0,0,0,,All right.
Dialogue: 0,00:10:41.840,00:10:47.820,辉英,,0,0,0,,And so, speed of the characteristics or speed of the shockwave.
Dialogue: 0,00:10:47.820,00:10:48.180,辉英,,0,0,0,,Let's say.
Dialogue: 0,00:10:48.180,00:10:57.740,辉英,,0,0,0,,Ss is equal to u of 2 to n plus u of 1 to n minus 1 divided by 2.
Dialogue: 0,00:10:58.140,00:10:58.400,辉英,,0,0,0,,Right.
Dialogue: 0,00:10:58.480,00:11:04.860,辉英,,0,0,0,,So, that's what is going to be deciding if we are going to use upwind or downwind.
Dialogue: 0,00:11:06.600,00:11:07.160,辉英,,0,0,0,,Yes?
Dialogue: 0,00:11:07.800,00:11:13.940,辉英,,0,0,0,,So, in this case, because f is u squared over 2, we were able to conveniently get rid of the differences.
Dialogue: 0,00:11:14.420,00:11:14.720,辉英,,0,0,0,,Yes.
Dialogue: 0,00:11:14.920,00:11:18.160,辉英,,0,0,0,,But there are cases where that's not going to be.
Dialogue: 0,00:11:18.180,00:11:18.440,辉英,,0,0,0,,Okay.
Dialogue: 0,00:11:18.820,00:11:19.300,辉英,,0,0,0,,Okay.
Dialogue: 0,00:11:19.420,00:11:25.860,辉英,,0,0,0,,So, you are concerned when you don't have an analytical formula you can use in general.
Dialogue: 0,00:11:26.140,00:11:34.740,辉英,,0,0,0,,So, if you don't have an analytical formula to use in general, you have to separate the case where ui is almost equal to ui plus 1.
Dialogue: 0,00:11:35.220,00:11:39.640,辉英,,0,0,0,,In that case, if ui is almost equal to ui plus 1, what is this?
Dialogue: 0,00:11:39.760,00:11:40.880,辉英,,0,0,0,,What is the ratio?
Dialogue: 0,00:11:41.280,00:11:42.440,辉英,,0,0,0,,Delta f over delta u.
Dialogue: 0,00:11:44.580,00:11:46.740,辉英,,0,0,0,,The derivative of f to u.
Dialogue: 0,00:11:46.740,00:11:47.180,辉英,,0,0,0,,Right.
Dialogue: 0,00:11:47.340,00:11:48.140,辉英,,0,0,0,,So, generally.
Dialogue: 0,00:11:48.440,00:11:50.480,辉英,,0,0,0,,You have like an epsilon criterion.
Dialogue: 0,00:11:50.680,00:11:58.000,辉英,,0,0,0,,If the difference between ui and ui plus 1 is less than like 10 to the minus 6 or something, you use the derivative formula.
Dialogue: 0,00:11:58.240,00:12:01.140,辉英,,0,0,0,,If it's larger than that, you use the delta formula.
