[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None
PlayResX: 1080
PlayResY: 720

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: 辉英,Tahoma,35,&H00FFFFFF,&H000000FF,&H003B3C3D,&H00000000,0,0,0,0,70,70,1,0,1,1.3,0.2,2,0,0,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,00:00:00.000,00:00:06.700,辉英,,0,0,0,,Previously, we have discussed the proper way to solve conservation loss, that is, finite volume.
Dialogue: 0,00:00:07.960,00:00:15.200,辉英,,0,0,0,,And we discussed what is the proper way to reconstruct the flux using only the cell averages.
Dialogue: 0,00:00:16.140,00:00:22.120,辉英,,0,0,0,,In the beginning, we tried a central flux, which didn't work at all for shock waves.
Dialogue: 0,00:00:22.120,00:00:30.800,辉英,,0,0,0,,Whenever we get a shock wave, we create wild oscillations if you just take the central flux approach.
Dialogue: 0,00:00:31.820,00:00:41.780,辉英,,0,0,0,,And then we decided to use upwinding flux, which produced the correct behavior around shock waves,
Dialogue: 0,00:00:42.360,00:00:45.900,辉英,,0,0,0,,but didn't always produce a physical solution.
Dialogue: 0,00:00:47.460,00:00:49.620,辉英,,0,0,0,,And then we introduced the entropy condition.
Dialogue: 0,00:00:49.800,00:00:51.620,辉英,,0,0,0,,The entropy condition says that...
Dialogue: 0,00:00:52.120,00:00:59.620,辉英,,0,0,0,,the characteristic lines can run into discontinuities, but they cannot emerge from discontinuities
Dialogue: 0,00:01:00.680,00:01:06.720,辉英,,0,0,0,,for physical reasons, because physically there is always an infinitesimal viscosity there
Dialogue: 0,00:01:06.900,00:01:15.320,辉英,,0,0,0,,that is going to smooth out, that is going to expand any discontinuities where characteristics can go out of.
Dialogue: 0,00:01:16.280,00:01:20.360,辉英,,0,0,0,,It will instantaneously make that discontinuity no longer a discontinuity.
Dialogue: 0,00:01:20.600,00:01:22.100,辉英,,0,0,0,,While if you have a
Dialogue: 0,00:01:22.260,00:01:31.780,辉英,,0,0,0,,characteristic running into a discontinuity, that counteracts with a very small amount of viscosity and maintains that discontinuity.
Dialogue: 0,00:01:32.440,00:01:39.780,辉英,,0,0,0,,We discussed what is the proper way to solve equations and to get solutions that are physically correct.
Dialogue: 0,00:01:40.980,00:01:45.420,辉英,,0,0,0,,That leads us to the derivation of the Godunov scheme.
Dialogue: 0,00:01:46.980,00:01:52.020,辉英,,0,0,0,,Okay, the Godunov scheme looks at the correct flux.
Dialogue: 0,00:01:52.260,00:01:54.260,辉英,,0,0,0,,At t plus epsilon.
Dialogue: 0,00:01:55.100,00:02:01.700,辉英,,0,0,0,,It solves a discontinuous problem for infinitesimal amount of time analytically.
Dialogue: 0,00:02:01.700,00:02:05.460,辉英,,0,0,0,,And look at the flux after that infinitesimal amount of time.
Dialogue: 0,00:02:06.340,00:02:08.500,辉英,,0,0,0,,And that is the correct flux to use.
Dialogue: 0,00:02:09.920,00:02:19.660,辉英,,0,0,0,,Right, so these are what we discussed over the last lecture, but we found that all of this is going to only give us a first-order scheme.
Dialogue: 0,00:02:19.940,00:02:21.940,辉英,,0,0,0,,So in this lecture, we are going to discuss
Dialogue: 0,00:02:22.100,00:02:31.460,辉英,,0,0,0,,how do we get more than first-order schemes using the still, the physically correct numerical flux, the Godunov scheme.
Dialogue: 0,00:02:31.460,00:02:34.260,辉英,,0,0,0,,The key to that lies in reconstruction.
Dialogue: 0,00:02:34.260,00:02:38.900,辉英,,0,0,0,,Let's draw our solution as a function of x at a particular moment.
Dialogue: 0,00:02:40.740,00:02:43.860,辉英,,0,0,0,,So infinite volume, we have the cell averages.
Dialogue: 0,00:02:43.860,00:02:51.060,辉英,,0,0,0,,So let's represent the cell averages using piecewise constant lines.
Dialogue: 0,00:02:52.100,00:03:01.140,辉英,,0,0,0,,And it is exactly this piecewise constant solution that we used in our Godunov numerical flux in the last lecture.
Dialogue: 0,00:03:01.940,00:03:08.900,辉英,,0,0,0,,We looked at this discontinuous solution over here and see how it will evolve after epsilon amount of time.
Dialogue: 0,00:03:08.900,00:03:12.580,辉英,,0,0,0,,And what is the flux after epsilon amount of time at that interface.
Dialogue: 0,00:03:13.860,00:03:20.580,辉英,,0,0,0,,The problem, the reason why it is only first order is not because of the way we are computing the flux,
Dialogue: 0,00:03:20.580,00:03:21.940,辉英,,0,0,0,,but because of the way we are learning the flux.
Dialogue: 0,00:03:21.940,00:03:23.940,辉英,,0,0,0,,We are looking at the solution.
Dialogue: 0,00:03:23.940,00:03:28.260,辉英,,0,0,0,,We are reconstructing the solution only up to first order.
Dialogue: 0,00:03:28.260,00:03:31.380,辉英,,0,0,0,,It's a piecewise constant reconstruction.
Dialogue: 0,00:03:31.380,00:03:39.780,辉英,,0,0,0,,In this lecture, we will still use the same numerical flux, but reconstruct the solution in a more accurate way.
Dialogue: 0,00:03:39.780,00:03:43.780,辉英,,0,0,0,,We want to produce a second-order reconstruction.
Dialogue: 0,00:03:43.780,00:03:48.180,辉英,,0,0,0,,We want to produce a second-order reconstruction,
Dialogue: 0,00:03:48.180,00:03:51.780,辉英,,0,0,0,,not just by connecting the two.
Dialogue: 0,00:03:51.780,00:03:55.780,辉英,,0,0,0,,We want to reconstruct the two cell centers because if we do that,
Dialogue: 0,00:03:55.780,00:04:00.820,辉英,,0,0,0,,we get back to our central flux scheme, which we know doesn't work for shock waves.
Dialogue: 0,00:04:00.820,00:04:07.940,辉英,,0,0,0,,What we want to do is we want to reconstruct the scheme to second order
Dialogue: 0,00:04:07.940,00:04:14.020,辉英,,0,0,0,,using only information from one side of the interface.
Dialogue: 0,00:04:14.020,00:04:18.500,辉英,,0,0,0,,We want to extrapolate instead of interpolate.
Dialogue: 0,00:04:18.500,00:04:20.900,辉英,,0,0,0,,So for example, if I'm looking at this interface,
Dialogue: 0,00:04:21.780,00:04:25.700,辉英,,0,0,0,,if I'm looking at this interface over here,
Dialogue: 0,00:04:25.700,00:04:36.180,辉英,,0,0,0,,I want to reconstruct the left-hand side of this solution by using only the cell averages over the left.
Dialogue: 0,00:04:36.180,00:04:41.460,辉英,,0,0,0,,For example, I can produce a reconstruction by connecting these two centers,
Dialogue: 0,00:04:41.460,00:04:46.500,辉英,,0,0,0,,and here is my reconstruction from the left.
Dialogue: 0,00:04:46.500,00:04:51.700,辉英,,0,0,0,,I want to reconstruct information from the right using this information and this information.
Dialogue: 0,00:04:51.700,00:04:54.100,辉英,,0,0,0,,For example, connecting these two dots,
Dialogue: 0,00:04:54.100,00:05:00.100,辉英,,0,0,0,,that will allow me to reconstruct a solution over here.
Dialogue: 0,00:05:00.100,00:05:08.500,辉英,,0,0,0,,This is going to ensure that if the wave travels towards the right,
Dialogue: 0,00:05:08.500,00:05:15.380,辉英,,0,0,0,,using good enough numerical flux is going to compute the flux according to the left-hand side solution here.
Dialogue: 0,00:05:15.380,00:05:18.340,辉英,,0,0,0,,If the wave is traveling towards the left,
Dialogue: 0,00:05:18.340,00:05:21.620,辉英,,0,0,0,,the good enough numerical flux is going to compute the flux using the left.
Dialogue: 0,00:05:21.620,00:05:24.020,辉英,,0,0,0,,So we're still using the right-hand side solution here.
Dialogue: 0,00:05:24.020,00:05:28.980,辉英,,0,0,0,,So we're still using the upwinding side of information,
Dialogue: 0,00:05:28.980,00:05:35.220,辉英,,0,0,0,,which is physical, but we have a construction that is second order.
Dialogue: 0,00:05:35.220,00:05:40.260,辉英,,0,0,0,,All right, so here I'm drawing a very discontinuous solution over here,
Dialogue: 0,00:05:40.260,00:05:44.740,辉英,,0,0,0,,but if you imagine I'm doing the same reconstruction over here,
Dialogue: 0,00:05:44.740,00:05:47.300,辉英,,0,0,0,,over a smooth region of the solution,
Dialogue: 0,00:05:47.300,00:05:50.580,辉英,,0,0,0,,then I'm going to be doing a really good job
Dialogue: 0,00:05:50.580,00:05:51.540,辉英,,0,0,0,,by connecting these two centers.
Dialogue: 0,00:05:51.540,00:05:54.100,辉英,,0,0,0,,So if I connect these two, I get a solution here.
Dialogue: 0,00:05:54.100,00:05:56.900,辉英,,0,0,0,,By connecting these two, I'm getting a solution here,
Dialogue: 0,00:05:56.900,00:06:00.740,辉英,,0,0,0,,which really gets us a good reconstruction.
Dialogue: 0,00:06:00.740,00:06:05.780,辉英,,0,0,0,,Okay, so this kind of extrapolation from only one side
Dialogue: 0,00:06:05.780,00:06:09.300,辉英,,0,0,0,,gives us the correct behavior around shock waves
Dialogue: 0,00:06:09.300,00:06:16.500,辉英,,0,0,0,,and a very accurate reconstruction in smooth regions.
Dialogue: 0,00:06:16.500,00:06:20.980,辉英,,0,0,0,,Okay, so this is the approach we are going to be using here.
Dialogue: 0,00:06:20.980,00:06:26.180,辉英,,0,0,0,,So we're using, we are constructing u,
Dialogue: 0,00:06:26.180,00:06:29.940,辉英,,0,0,0,,so let's say this is the ith cell average,
Dialogue: 0,00:06:29.940,00:06:33.220,辉英,,0,0,0,,this is the i plus 1 cell average.
Dialogue: 0,00:06:33.220,00:06:41.380,辉英,,0,0,0,,We are going to reconstruct u at i plus half on the left,
Dialogue: 0,00:06:41.380,00:06:48.900,辉英,,0,0,0,,using information on the ith grid point and i minus 1 grid point.
Dialogue: 0,00:06:48.900,00:06:50.900,辉英,,0,0,0,,We are going to reconstruct
Dialogue: 0,00:06:50.980,00:06:53.540,辉英,,0,0,0,,the solution at the same grid point,
Dialogue: 0,00:06:53.540,00:06:55.620,辉英,,0,0,0,,but at the same interface,
Dialogue: 0,00:06:55.620,00:06:58.660,辉英,,0,0,0,,but immediately towards the right of the interface,
Dialogue: 0,00:06:58.660,00:07:05.220,辉英,,0,0,0,,using u i plus 1 and u i plus 2.
Dialogue: 0,00:07:05.220,00:07:09.300,辉英,,0,0,0,,And my flux at i plus half is equal to,
Dialogue: 0,00:07:09.300,00:07:17.140,辉英,,0,0,0,,let's imagine we write a function that computes the Godunov scheme.
Dialogue: 0,00:07:17.140,00:07:20.020,辉英,,0,0,0,,That takes two inputs.
Dialogue: 0,00:07:20.020,00:07:22.740,辉英,,0,0,0,,It takes the left value and the right value.
Dialogue: 0,00:07:22.740,00:07:29.300,辉英,,0,0,0,,Both are reconstructed from two cell averages.
Dialogue: 0,00:07:29.300,00:07:37.860,辉英,,0,0,0,,So I end up computing the flux using the four cells instead of two cells.
Dialogue: 0,00:07:37.860,00:07:44.340,辉英,,0,0,0,,And that gives me a more accurate second order solution.
Dialogue: 0,00:07:44.340,00:07:49.380,辉英,,0,0,0,,So how do we perform this reconstruction?
Dialogue: 0,00:07:49.380,00:07:54.820,辉英,,0,0,0,,So the first step is what we are going to be discussing today.
Dialogue: 0,00:07:54.820,00:07:55.380,辉英,,0,0,0,,Okay.
Dialogue: 0,00:07:55.380,00:08:03.060,辉英,,0,0,0,,The most obvious way of performing the reconstruction is a linear extrapolation.
Dialogue: 0,00:08:03.060,00:08:08.580,辉英,,0,0,0,,So linear extrapolation means looking at the value at these two cell averages
Dialogue: 0,00:08:08.580,00:08:13.060,辉英,,0,0,0,,and linearly extrapolate to here and linearly extrapolate to here.
Dialogue: 0,00:08:13.060,00:08:14.500,辉英,,0,0,0,,So we can do that.
Dialogue: 0,00:08:14.500,00:08:15.700,辉英,,0,0,0,,Unfortunately,
Dialogue: 0,00:08:15.700,00:08:17.940,辉英,,0,0,0,,it is going to create
Dialogue: 0,00:08:17.940,00:08:18.820,辉英,,0,0,0,,the solution.
Dialogue: 0,00:08:18.820,00:08:19.780,辉英,,0,0,0,,The so-called
Dialogue: 0,00:08:22.100,00:08:23.220,辉英,,0,0,0,,Gibbs phenomenon.
Dialogue: 0,00:08:24.580,00:08:30.260,辉英,,0,0,0,,So Gibbs phenomenon is something you observe around discontinuities
Dialogue: 0,00:08:30.820,00:08:32.980,辉英,,0,0,0,,where you have artificially,
Dialogue: 0,00:08:34.740,00:08:37.460,辉英,,0,0,0,,you have artificial oscillations going on.
Dialogue: 0,00:08:38.420,00:08:45.460,辉英,,0,0,0,,So the typical Gibbs phenomenon is when you should have a discontinuity like that,
Dialogue: 0,00:08:45.460,00:08:47.460,辉英,,0,0,0,,you observe something like this.
Dialogue: 0,00:08:48.820,00:08:52.660,辉英,,0,0,0,,So this is the so-called Gibbs phenomenon.
Dialogue: 0,00:08:52.660,00:09:05.780,辉英,,0,0,0,,And the reason you have this is because this reconstruction here and this reconstruction
Dialogue: 0,00:09:05.780,00:09:11.700,辉英,,0,0,0,,here around any large discontinuities creates a large overshoot.
Dialogue: 0,00:09:11.700,00:09:14.420,辉英,,0,0,0,,Overshoot and undershoot.
Dialogue: 0,00:09:14.420,00:09:16.820,辉英,,0,0,0,,So this is the so-called Gibbs phenomenon.
Dialogue: 0,00:09:16.820,00:09:17.300,辉英,,0,0,0,,Okay.
Dialogue: 0,00:09:17.300,00:09:17.940,辉英,,0,0,0,,So this is the so-called Gibbs phenomenon.
Dialogue: 0,00:09:17.940,00:09:19.140,辉英,,0,0,0,,So this is the so-called Gibbs phenomenon.
Dialogue: 0,00:09:19.140,00:09:19.640,辉英,,0,0,0,,Right.
Dialogue: 0,00:09:20.340,00:09:26.900,辉英,,0,0,0,,And this violates the correct behavior of a scalar conservation law,
Dialogue: 0,00:09:28.420,00:09:32.660,辉英,,0,0,0,,which diminishes the total variation of the solution.
Dialogue: 0,00:09:33.860,00:09:35.460,辉英,,0,0,0,,Remember the total variation?
Dialogue: 0,00:09:37.380,00:09:42.100,辉英,,0,0,0,,The total variation is defined as an integral over a region a to b,
Dialogue: 0,00:09:42.980,00:09:47.620,辉英,,0,0,0,,the absolute value of the derivative integrated over dx.
Dialogue: 0,00:09:47.940,00:09:58.660,辉英,,0,0,0,,And numerically, it is equal to the summation goes from i to i1 to i2.
Dialogue: 0,00:09:58.660,00:10:04.420,辉英,,0,0,0,,So this is summing over a range of grid points.
Dialogue: 0,00:10:06.100,00:10:13.620,辉英,,0,0,0,,And instead of derivative, we have u of i minus u of i minus 1 taking the absolute value.
Dialogue: 0,00:10:13.620,00:10:17.220,辉英,,0,0,0,,So this is the discrete analog of the total variation.
Dialogue: 0,00:10:17.940,00:10:22.580,辉英,,0,0,0,,Instead of taking the derivative, you take the difference between two grid points.
Dialogue: 0,00:10:22.580,00:10:27.540,辉英,,0,0,0,,And you can divide by delta x and multiply by delta x.
Dialogue: 0,00:10:27.540,00:10:28.660,辉英,,0,0,0,,It's going to be the same.
Dialogue: 0,00:10:28.660,00:10:30.900,辉英,,0,0,0,,It's a discretization of the total variation.
Dialogue: 0,00:10:30.900,00:10:33.060,辉英,,0,0,0,,Right.
Dialogue: 0,00:10:33.060,00:10:42.340,辉英,,0,0,0,,Just count how much change has happened when you walk through the sequence of grid points.
Dialogue: 0,00:10:42.340,00:10:47.380,辉英,,0,0,0,,So we want this total variation to decrease monotonically.
Dialogue: 0,00:10:47.380,00:10:52.260,辉英,,0,0,0,,At least not increasing when we time integrate the solution.
Dialogue: 0,00:10:53.460,00:10:58.740,辉英,,0,0,0,,If we create this kind of overshoot when we reconstruct the solution,
Dialogue: 0,00:10:58.740,00:11:05.620,辉英,,0,0,0,,then the total variation increases because I'm creating new extrema, new minimum, and new maximum.
Dialogue: 0,00:11:06.420,00:11:09.540,辉英,,0,0,0,,I'm increasing and potentially increasing the local maximum
Dialogue: 0,00:11:09.540,00:11:13.060,辉英,,0,0,0,,and decreasing the local minimum through the reconstruction.
Dialogue: 0,00:11:13.060,00:11:14.500,辉英,,0,0,0,,And that's what we want to avoid.
Dialogue: 0,00:11:15.620,00:11:17.220,辉英,,0,0,0,,Any questions of what we're doing?
Dialogue: 0,00:11:17.380,00:11:18.340,辉英,,0,0,0,,Any questions of what we want to achieve?
Dialogue: 0,00:11:18.340,00:11:23.460,辉英,,0,0,0,,Oh, it should not increase as you time integrate forward.
Dialogue: 0,00:11:23.460,00:11:26.340,辉英,,0,0,0,,So the total variation, that's a good question.
Dialogue: 0,00:11:26.340,00:11:39.380,辉英,,0,0,0,,So the criterion is the time derivative of the total variation is less or equal to zero.
Dialogue: 0,00:11:40.660,00:11:45.460,辉英,,0,0,0,,So we want this to not increase over time, not as I decrease.
Dialogue: 0,00:11:45.460,00:11:47.300,辉英,,0,0,0,,So that's the correct behavior for scalar.
Dialogue: 0,00:11:47.380,00:11:50.420,辉英,,0,0,0,,So we want to avoid scalar conservation loss because in smooth regions,
Dialogue: 0,00:11:50.420,00:11:52.260,辉英,,0,0,0,,the solution follows characteristics.
Dialogue: 0,00:11:52.260,00:11:56.020,辉英,,0,0,0,,So any minimum or maximum is conserved.
Dialogue: 0,00:11:57.860,00:12:02.580,辉英,,0,0,0,,If there is no discontinuities, the time derivative of our total variation should be zero.
Dialogue: 0,00:12:03.780,00:12:03.940,辉英,,0,0,0,,Right.
Dialogue: 0,00:12:03.940,00:12:11.540,辉英,,0,0,0,,Because the solution is morphed in shape, but it never changes its shape.
Dialogue: 0,00:12:11.540,00:12:17.220,辉英,,0,0,0,,So any monotonically increasing regions, it's still going to be monotonically increasing.
Dialogue: 0,00:12:17.380,00:12:20.740,辉英,,0,0,0,,It's just the bounds of the region are shifted over time.
Dialogue: 0,00:12:20.740,00:12:24.260,辉英,,0,0,0,,Any monotonically decreasing regions are just shifted in space.
Dialogue: 0,00:12:24.260,00:12:25.540,辉英,,0,0,0,,Yes.
Dialogue: 0,00:12:25.540,00:12:30.500,辉英,,0,0,0,,So the question is, can you think of the Gibbs phenomenon in terms of the
Dialogue: 0,00:12:30.500,00:12:32.020,辉英,,0,0,0,,newman stability analysis?
Dialogue: 0,00:12:33.940,00:12:38.980,辉英,,0,0,0,,You can think of the Gibbs phenomenon as a result of dispersion error.
Dialogue: 0,00:12:40.420,00:12:44.820,辉英,,0,0,0,,So dispersion error moves waves to incorrect places.
Dialogue: 0,00:12:44.820,00:12:45.620,辉英,,0,0,0,,And this results in a new wave.
Dialogue: 0,00:12:45.620,00:12:46.500,辉英,,0,0,0,,So dispersion error moves waves to incorrect places.
Dialogue: 0,00:12:46.500,00:12:47.220,辉英,,0,0,0,,And this results in a new wave.
Dialogue: 0,00:12:47.220,00:12:49.220,辉英,,0,0,0,,And this results in the oscillations over here.
Dialogue: 0,00:12:51.060,00:12:56.580,辉英,,0,0,0,,And this is most obvious around shock waves because around shock waves,
Dialogue: 0,00:12:56.580,00:12:59.620,辉英,,0,0,0,,you have very high frequency content of the solution.
Dialogue: 0,00:12:59.620,00:13:06.180,辉英,,0,0,0,,So if you have dispersion error, you are moving these high frequency contents to wrong places,
Dialogue: 0,00:13:06.180,00:13:08.740,辉英,,0,0,0,,to places away from the shock wave.
Dialogue: 0,00:13:10.260,00:13:10.580,辉英,,0,0,0,,All right.
Dialogue: 0,00:13:11.460,00:13:17.140,辉英,,0,0,0,,And also, most time when we have a discontinuity, that's when we have a nonlinear content.
Dialogue: 0,00:13:17.140,00:13:19.140,辉英,,0,0,0,,So we have a nonlinear conservation law.
Dialogue: 0,00:13:19.140,00:13:21.300,辉英,,0,0,0,,We have characteristics running into each other.
Dialogue: 0,00:13:21.300,00:13:26.900,辉英,,0,0,0,,If you have linear conservation laws, all the characteristics are parallel to each other.
Dialogue: 0,00:13:26.900,00:13:32.180,辉英,,0,0,0,,And you rarely have discontinuities that are as sharp as that.
Dialogue: 0,00:13:33.780,00:13:39.900,辉英,,0,0,0,,So the objective in this lecture is to reconstruct the solution to second-order accuracy without overshooting.
