[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None
PlayResX: 1080
PlayResY: 720

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,Arial,20,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1
Style: 辉英,Tahoma,35,&H00FFFFFF,&H000000FF,&H003B3C3D,&H00000000,0,0,0,0,70,70,1,0,1,1.3,0.2,2,0,0,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Dialogue: 0,00:00:00.000,00:00:04.540,辉英,,0,0,0,,We have essential boundary conditions, and we have natural boundary conditions.
Dialogue: 0,00:00:06.840,00:00:14.180,辉英,,0,0,0,,Essential boundary conditions work by restricting the space for which we can have the solution.
Dialogue: 0,00:00:15.220,00:00:19.880,辉英,,0,0,0,,Natural boundary conditions don't restrict the space. It comes out naturally from the weak form.
Dialogue: 0,00:00:21.140,00:00:25.860,辉英,,0,0,0,,What type of boundary conditions did we set in the two-dimensional example we just went through?
Dialogue: 0,00:00:25.860,00:00:31.840,辉英,,0,0,0,,Essential, because we are restricting the space. We're removing degrees of freedoms on the boundary.
Dialogue: 0,00:00:33.860,00:00:41.840,辉英,,0,0,0,,So let's also discuss what we can do for natural boundary conditions.
Dialogue: 0,00:00:42.900,00:00:49.320,辉英,,0,0,0,,So we have the divergence of gradient of u plus f equal to zero.
Dialogue: 0,00:00:49.840,00:00:55.680,辉英,,0,0,0,,We cannot have the numerous boundary conditions everywhere.
Dialogue: 0,00:00:55.860,00:01:00.000,辉英,,0,0,0,,So let's say we have split the domain into two parts.
Dialogue: 0,00:01:01.700,00:01:04.840,辉英,,0,0,0,,This is partial omega 1, partial omega 2.
Dialogue: 0,00:01:05.420,00:01:13.020,辉英,,0,0,0,,So let's say u at partial omega 1 is equal to zero, and how do we set the Newman boundary condition?
Dialogue: 0,00:01:14.400,00:01:22.060,辉英,,0,0,0,,The other domain, we set it as the normal dot with the gradient of u equal to zero.
Dialogue: 0,00:01:24.660,00:01:25.300,辉英,,0,0,0,,Okay.
Dialogue: 0,00:01:25.860,00:01:30.480,辉英,,0,0,0,,So this is usually, for example, if you are solving a heat transfer problem,
Dialogue: 0,00:01:31.980,00:01:35.300,辉英,,0,0,0,,this is saying that u is the solution of the temperature.
Dialogue: 0,00:01:36.000,00:01:40.660,辉英,,0,0,0,,This is saying that I'm fixing the temperature in this part of the domain.
Dialogue: 0,00:01:41.680,00:01:47.620,辉英,,0,0,0,,For example, I'm having this in contact with a heat source or heat sink
Dialogue: 0,00:01:47.620,00:01:51.200,辉英,,0,0,0,,that maintains that boundary to be a constant temperature.
Dialogue: 0,00:01:52.100,00:01:54.920,辉英,,0,0,0,,While on partial omega 2,
Dialogue: 0,00:01:55.860,00:02:01.860,辉英,,0,0,0,,I have the gradient of the heat dot with the normal equal to zero.
Dialogue: 0,00:02:01.860,00:02:02.860,辉英,,0,0,0,,What does that mean?
Dialogue: 0,00:02:02.860,00:02:05.860,辉英,,0,0,0,,If I have a heat transfer problem?
Dialogue: 0,00:02:05.860,00:02:06.860,辉英,,0,0,0,,Yes?
Dialogue: 0,00:02:06.860,00:02:12.860,辉英,,0,0,0,,The flux is equal to zero, which means no heat goes through the boundary.
Dialogue: 0,00:02:12.860,00:02:15.860,辉英,,0,0,0,,It's insulated on the other side.
Dialogue: 0,00:02:15.860,00:02:16.860,辉英,,0,0,0,,Right?
Dialogue: 0,00:02:16.860,00:02:19.860,辉英,,0,0,0,,So these are the two types of boundary conditions we can set,
Dialogue: 0,00:02:19.860,00:02:23.860,辉英,,0,0,0,,Dirichlet and Newman boundary conditions.
Dialogue: 0,00:02:23.860,00:02:24.980,辉英,,0,0,0,,Of course, you can set these two types of boundary conditions.
Dialogue: 0,00:02:24.980,00:02:25.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:02:25.480,00:02:28.480,辉英,,0,0,0,,So I set this to be non-zero to a certain other value.
Dialogue: 0,00:02:28.480,00:02:32.480,辉英,,0,0,0,,That means I'm giving a fixed heat flux through the boundary.
Dialogue: 0,00:02:32.480,00:02:33.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:02:33.480,00:02:36.480,辉英,,0,0,0,,So how do we set this type of boundary conditions?
Dialogue: 0,00:02:36.480,00:02:40.480,辉英,,0,0,0,,It turns out if we derive the weak form, it'll come out naturally.
Dialogue: 0,00:02:40.480,00:02:52.480,辉英,,0,0,0,,So the weak form works by integrating the equation with the product of a test function.
Dialogue: 0,00:02:55.480,00:03:00.480,辉英,,0,0,0,,And through integration by parts,
Dialogue: 0,00:03:00.480,00:03:08.480,辉英,,0,0,0,,this came out to be V times n dot with the grad of U.
Dialogue: 0,00:03:08.480,00:03:10.480,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:10.480,00:03:17.480,辉英,,0,0,0,,At the boundaries minus the weak form we had before.
Dialogue: 0,00:03:17.480,00:03:19.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:03:19.480,00:03:20.480,辉英,,0,0,0,,So we have the weak form.
Dialogue: 0,00:03:20.480,00:03:21.480,辉英,,0,0,0,,We have the non-zero.
Dialogue: 0,00:03:21.480,00:03:22.480,辉英,,0,0,0,,We have the non-zero.
Dialogue: 0,00:03:22.480,00:03:23.480,辉英,,0,0,0,,We have the non-zero.
Dialogue: 0,00:03:23.480,00:03:24.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:03:24.480,00:03:25.480,辉英,,0,0,0,,So we have the non-zero.
Dialogue: 0,00:03:25.480,00:03:39.480,辉英,,0,0,0,,And this boundary term is, it is zero for partial omega 1 because we restrict the space.
Dialogue: 0,00:03:39.480,00:03:42.480,辉英,,0,0,0,,And therefore, V is going to be zero at the boundary.
Dialogue: 0,00:03:42.480,00:03:53.480,辉英,,0,0,0,,It is going to be zero at partial omega 2 because the grad U dot n should satisfy the Newman boundary condition.
Dialogue: 0,00:03:53.480,00:03:54.480,辉英,,0,0,0,,Right?
Dialogue: 0,00:03:54.480,00:04:04.480,辉英,,0,0,0,,So that means we don't need to do anything at partial omega 2 other than not restricting the space to set it to zero.
Dialogue: 0,00:04:04.480,00:04:06.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:04:06.480,00:04:10.480,辉英,,0,0,0,,In order for you to satisfy that Newman boundary condition.
Dialogue: 0,00:04:10.480,00:04:15.480,辉英,,0,0,0,,So, for example, in the code, let's do a very simple thing.
Dialogue: 0,00:04:15.480,00:04:21.480,辉英,,0,0,0,,Remember I said this E, the boundary E, is,
Dialogue: 0,00:04:21.480,00:04:27.480,辉英,,0,0,0,,has a flag at the very end.
Dialogue: 0,00:04:27.480,00:04:34.480,辉英,,0,0,0,,So here, this 5, I think it corresponds to which edge it is.
Dialogue: 0,00:04:34.480,00:04:50.480,辉英,,0,0,0,,So, for example, if I plot the P of x direction, E of, so, 0 to 5.
Dialogue: 0,00:04:50.480,00:04:57.480,辉英,,0,0,0,,E of 1, 1 to 5.
Dialogue: 0,00:04:57.480,00:04:59.480,辉英,,0,0,0,,So this is the first edge.
Dialogue: 0,00:04:59.480,00:05:06.480,辉英,,0,0,0,,And, is that right?
Dialogue: 0,00:05:06.480,00:05:09.480,辉英,,0,0,0,,Second dimension.
Dialogue: 0,00:05:09.480,00:05:12.480,辉英,,0,0,0,,So this is 1 by, okay.
Dialogue: 0,00:05:12.480,00:05:16.480,辉英,,0,0,0,,So then I should do P of 1 and E of 2, 1 to 5.
Dialogue: 0,00:05:16.480,00:05:19.480,辉英,,0,0,0,,So this is the x direction of the boundary.
Dialogue: 0,00:05:19.480,00:05:26.480,辉英,,0,0,0,,This is the x direction of, I'm just plotting the first 5 edges corresponding to the flag 5 equal to 1.
Dialogue: 0,00:05:26.480,00:05:37.480,辉英,,0,0,0,,And the y direction, what I'm going to get is this.
Dialogue: 0,00:05:37.480,00:05:39.480,辉英,,0,0,0,,That's weird.
Dialogue: 0,00:05:39.480,00:05:43.480,辉英,,0,0,0,,Oh, I have another bunch of 1s over there.
Dialogue: 0,00:05:43.480,00:05:48.480,辉英,,0,0,0,,So instead of 1 to 5, I should be setting,
Dialogue: 0,00:05:48.480,00:05:53.480,辉英,,0,0,0,,setting E of 5 equal to 1.
Dialogue: 0,00:05:53.480,00:05:59.480,辉英,,0,0,0,,So I'm just going to remove this 1 to 5 by this flag.
Dialogue: 0,00:05:59.480,00:06:04.480,辉英,,0,0,0,,I have one more thing I need to replace, I guess.
Dialogue: 0,00:06:04.480,00:06:07.480,辉英,,0,0,0,,Right, so that's one of the straight edges.
Dialogue: 0,00:06:07.480,00:06:12.480,辉英,,0,0,0,,So let's take an example of setting one of these straight edges to,
Dialogue: 0,00:06:12.480,00:06:14.480,辉英,,0,0,0,,to a Newman boundary condition.
Dialogue: 0,00:06:14.480,00:06:16.480,辉英,,0,0,0,,Okay.
Dialogue: 0,00:06:16.480,00:06:18.480,辉英,,0,0,0,,The only thing we have to do,
Dialogue: 0,00:06:18.480,00:06:23.480,辉英,,0,0,0,,is to remove this, is to do a little bit trick on the IB, right?
Dialogue: 0,00:06:23.480,00:06:30.480,辉英,,0,0,0,,So we did, we figured out IB was equal to all these,
Dialogue: 0,00:06:30.480,00:06:33.480,辉英,,0,0,0,,all these edges, right?
Dialogue: 0,00:06:33.480,00:06:39.480,辉英,,0,0,0,,So now we want to remove a certain set of points from IB.
Dialogue: 0,00:06:39.480,00:06:44.480,辉英,,0,0,0,,So we want to remove the,
Dialogue: 0,00:06:44.480,00:06:45.480,辉英,,0,0,0,,okay.
Dialogue: 0,00:06:45.480,00:06:46.480,辉英,,0,0,0,,So let's only,
Dialogue: 0,00:06:46.480,00:06:48.480,辉英,,0,0,0,,so let's only keep,
Dialogue: 0,00:06:48.480,00:06:50.480,辉英,,0,0,0,,so to make it easier, let's only,
Dialogue: 0,00:06:50.480,00:06:55.480,辉英,,0,0,0,,let's do Newman boundary condition to all the edges except for one of the edges.
Dialogue: 0,00:06:55.480,00:07:02.480,辉英,,0,0,0,,So we are going to set it to E of 5 star equal to 1.
Dialogue: 0,00:07:02.480,00:07:04.480,辉英,,0,0,0,,So we are going to,
Dialogue: 0,00:07:04.480,00:07:06.480,辉英,,0,0,0,,we are going to set IB,
Dialogue: 0,00:07:06.480,00:07:10.480,辉英,,0,0,0,,which is the value, which is the basic functions we restrict to 0,
Dialogue: 0,00:07:10.480,00:07:16.480,辉英,,0,0,0,,only for the points along the first edge.
Dialogue: 0,00:07:16.480,00:07:19.480,辉英,,0,0,0,,So now IB is going to be a much lower dimension,
Dialogue: 0,00:07:19.480,00:07:21.480,辉英,,0,0,0,,it's much less number of points.
Dialogue: 0,00:07:21.480,00:07:23.480,辉英,,0,0,0,,It only has 11 points.
Dialogue: 0,00:07:23.480,00:07:26.480,辉英,,0,0,0,,So we are going to set 0,
Dialogue: 0,00:07:26.480,00:07:29.480,辉英,,0,0,0,,this is bounded condition, only on these 11 points.
Dialogue: 0,00:07:29.480,00:07:34.480,辉英,,0,0,0,,And all the other bounded conditions, we just don't do anything to it.
Dialogue: 0,00:07:34.480,00:07:37.480,辉英,,0,0,0,,And according to our analysis on the natural bounded condition,
Dialogue: 0,00:07:37.480,00:07:42.480,辉英,,0,0,0,,the bounded condition is naturally satisfied on the other points should be what?
Dialogue: 0,00:07:42.480,00:07:45.480,辉英,,0,0,0,,Should be a 0 Newman boundary condition, right?
Dialogue: 0,00:07:46.480,00:07:53.480,辉英,,0,0,0,,So now we have modified the IB and let's run this again.
Dialogue: 0,00:07:53.480,00:07:55.480,辉英,,0,0,0,,And this obviously ran.
Dialogue: 0,00:07:55.480,00:08:00.480,辉英,,0,0,0,,And let's do a try serve of this time.
Dialogue: 0,00:08:00.480,00:08:01.480,辉英,,0,0,0,,All right.
Dialogue: 0,00:08:01.480,00:08:05.480,辉英,,0,0,0,,So that's the solution we get.
Dialogue: 0,00:08:05.480,00:08:11.480,辉英,,0,0,0,,Obviously, we are satisfying a 0 Dirichlet bounded condition on this particular edge, right?
Dialogue: 0,00:08:11.480,00:08:16.480,辉英,,0,0,0,,So that's the edge that we set, still included in the set of IBs.
Dialogue: 0,00:08:16.480,00:08:21.480,辉英,,0,0,0,,And all the other bounded conditions, let's actually look at the edge on
Dialogue: 0,00:08:21.480,00:08:24.480,辉英,,0,0,0,,to make it a little bit more obvious that.
Dialogue: 0,00:08:24.480,00:08:30.480,辉英,,0,0,0,,So we are, for example, we are looking at the left edge over here, right?
Dialogue: 0,00:08:30.480,00:08:33.480,辉英,,0,0,0,,So from this particular point of view,
Dialogue: 0,00:08:33.480,00:08:38.480,辉英,,0,0,0,,we are actually satisfying the normal derivative equal to 0 condition.
Dialogue: 0,00:08:38.480,00:08:43.480,辉英,,0,0,0,,The derivative in normal to this edge should be on the horizontal direction
Dialogue: 0,00:08:43.480,00:08:45.480,辉英,,0,0,0,,when I view it at this angle, right?
Dialogue: 0,00:08:45.480,00:08:50.480,辉英,,0,0,0,,The horizontal direction, the derivative is equal to 0.
Dialogue: 0,00:08:50.480,00:08:54.480,辉英,,0,0,0,,If I rotate it again, look at this edge from edge on,
Dialogue: 0,00:08:54.480,00:08:58.480,辉英,,0,0,0,,the normal derivative is also going to be equal to 0.
Dialogue: 0,00:08:58.480,00:09:02.480,辉英,,0,0,0,,So for any of these other edges, if you look at the normal,
Dialogue: 0,00:09:02.480,00:09:06.480,辉英,,0,0,0,,the derivative normal to that edge, it's going to be 0.
Dialogue: 0,00:09:06.480,00:09:11.480,辉英,,0,0,0,,So that's how we are satisfying a natural bounded condition.
Dialogue: 0,00:09:11.480,00:09:14.480,辉英,,0,0,0,,Right?
Dialogue: 0,00:09:14.480,00:09:20.480,辉英,,0,0,0,,Questions on this one?
Dialogue: 0,00:09:20.480,00:09:21.480,辉英,,0,0,0,,Yes?
Dialogue: 0,00:09:21.480,00:09:26.480,辉英,,0,0,0,,In the non-square-thick thing, there's a minus,
Dialogue: 0,00:09:26.480,00:09:28.480,辉英,,0,0,0,,I can't remember what it comes from.
Dialogue: 0,00:09:28.480,00:09:35.480,辉英,,0,0,0,,So the second equation on this page, where does that minus come from?
Dialogue: 0,00:09:35.480,00:09:38.480,辉英,,0,0,0,,Oh, the minus comes from integration by parts.
Dialogue: 0,00:09:38.480,00:09:43.480,辉英,,0,0,0,,So the minus comes from the fact that
Dialogue: 0,00:09:43.480,00:09:53.480,辉英,,0,0,0,,if, so the integration by parts comes from taking v times gradient of u.
Dialogue: 0,00:09:53.480,00:09:56.480,辉英,,0,0,0,,So v is a scalar, gradient of u is a vector, right?
Dialogue: 0,00:09:56.480,00:09:57.480,辉英,,0,0,0,,So this is a vector.
Dialogue: 0,00:09:57.480,00:10:01.480,辉英,,0,0,0,,So let's define this as a vector.
Dialogue: 0,00:10:01.480,00:10:03.480,辉英,,0,0,0,,So let's define this as a w.
Dialogue: 0,00:10:03.480,00:10:05.480,辉英,,0,0,0,,It's a vector, right?
Dialogue: 0,00:10:05.480,00:10:10.480,辉英,,0,0,0,,So if I apply Gauss's theorem on this vector,
Dialogue: 0,00:10:10.480,00:10:11.480,辉英,,0,0,0,,which is Gauss,
Dialogue: 0,00:10:11.480,00:10:16.480,辉英,,0,0,0,,Gauss's theorem on this vector,
Dialogue: 0,00:10:16.480,00:10:21.480,辉英,,0,0,0,,which means that the divergence of the vector
Dialogue: 0,00:10:21.480,00:10:25.480,辉英,,0,0,0,,integrated over the whole domain should be equal to
Dialogue: 0,00:10:25.480,00:10:31.480,辉英,,0,0,0,,the normal, output normal times the vector integrated over the boundary of the domain.
Dialogue: 0,00:10:31.480,00:10:35.480,辉英,,0,0,0,,Right?
Dialogue: 0,00:10:35.480,00:10:38.480,辉英,,0,0,0,,Oh, by the way, thanks for notifying this.
Dialogue: 0,00:10:38.480,00:10:39.480,辉英,,0,0,0,,This is,
Dialogue: 0,00:10:39.480,00:10:42.480,辉英,,0,0,0,,as opposed to the one-dimensional integration by parts,
Dialogue: 0,00:10:42.480,00:10:47.480,辉英,,0,0,0,,the two-dimensional integration by parts is going to give me a boundary integral.
Dialogue: 0,00:10:47.480,00:10:51.480,辉英,,0,0,0,,So this term needs to be integrated not in the interior, but over the boundary.
Dialogue: 0,00:10:51.480,00:10:57.480,辉英,,0,0,0,,So this is ds, over the edge of the boundary.
Dialogue: 0,00:10:57.480,00:11:06.480,辉英,,0,0,0,,So the interior divergence integral is equal to the boundary normal dot vector integral.
Dialogue: 0,00:11:06.480,00:11:09.480,辉英,,0,0,0,,And then if I substitute,
Dialogue: 0,00:11:09.480,00:11:13.480,辉英,,0,0,0,,the particular form of w into both left and right hand side,
Dialogue: 0,00:11:13.480,00:11:16.480,辉英,,0,0,0,,the left hand side becomes
Dialogue: 0,00:11:16.480,00:11:21.480,辉英,,0,0,0,,the divergence of the product of a scalar and the vector
Dialogue: 0,00:11:21.480,00:11:28.480,辉英,,0,0,0,,is equal to two terms.
Dialogue: 0,00:11:28.480,00:11:32.480,辉英,,0,0,0,,This is equal to the gradient of the vector,
Dialogue: 0,00:11:32.480,00:11:37.480,辉英,,0,0,0,,dot product with the vector that is already inside,
Dialogue: 0,00:11:37.480,00:11:39.480,辉英,,0,0,0,,which is grad of u,
Dialogue: 0,00:11:39.480,00:11:42.480,辉英,,0,0,0,,plus v,
Dialogue: 0,00:11:42.480,00:11:44.480,辉英,,0,0,0,,which is the scalar,
Dialogue: 0,00:11:44.480,00:11:50.480,辉英,,0,0,0,,times the divergence of the vector that is already inside,
Dialogue: 0,00:11:50.480,00:11:52.480,辉英,,0,0,0,,which is grad of u.
Dialogue: 0,00:11:52.480,00:11:57.480,辉英,,0,0,0,,Alright, so this is just a chain rule for vector calculus.
Dialogue: 0,00:11:57.480,00:12:02.480,辉英,,0,0,0,,And so this is the left hand side,
Dialogue: 0,00:12:02.480,00:12:04.480,辉英,,0,0,0,,and the right hand side is,
Dialogue: 0,00:12:04.480,00:12:07.480,辉英,,0,0,0,,we also substitute this w,
Dialogue: 0,00:12:07.480,00:12:08.480,辉英,,0,0,0,,and that becomes v,
Dialogue: 0,00:12:08.480,00:12:10.480,辉英,,0,0,0,,v is a scalar,
Dialogue: 0,00:12:10.480,00:12:11.480,辉英,,0,0,0,,so I put it in front,
Dialogue: 0,00:12:11.480,00:12:18.480,辉英,,0,0,0,,and dot with grad of u, ds.
Dialogue: 0,00:12:18.480,00:12:25.480,辉英,,0,0,0,,So this is becoming our formula for integration by parsing 2D,
Dialogue: 0,00:12:25.480,00:12:28.480,辉英,,0,0,0,,which is basically taking this on the left hand side,
Dialogue: 0,00:12:28.480,00:12:31.480,辉英,,0,0,0,,and this on the right hand side,
Dialogue: 0,00:12:31.480,00:12:33.480,辉英,,0,0,0,,and this on the right hand side.
Dialogue: 0,00:12:33.480,00:12:36.480,辉英,,0,0,0,,Okay, so it says that the left hand side,
Dialogue: 0,00:12:36.480,00:12:42.480,辉英,,0,0,0,,the integration of v times the Laplacian of a scalar u,
Dialogue: 0,00:12:42.480,00:12:46.480,辉英,,0,0,0,,is going to be the boundary integral,
Dialogue: 0,00:12:46.480,00:12:48.480,辉英,,0,0,0,,the first term on the right hand side,
Dialogue: 0,00:12:48.480,00:12:52.480,辉英,,0,0,0,,v, n dot grad u, ds,
Dialogue: 0,00:12:52.480,00:12:56.480,辉英,,0,0,0,,minus integration over the whole domain,
Dialogue: 0,00:12:56.480,00:13:00.480,辉英,,0,0,0,,so that's the first term on the left hand side,
Dialogue: 0,00:13:00.480,00:13:03.480,辉英,,0,0,0,,grad v dot grad u, dx.
Dialogue: 0,00:13:03.480,00:13:05.480,辉英,,0,0,0,,So that's our formula for integration,
Dialogue: 0,00:13:05.480,00:13:07.480,辉英,,0,0,0,,by parsing 2D.
Dialogue: 0,00:13:07.480,00:13:11.480,辉英,,0,0,0,,That is going to help us derive all these equations.
